vim: ft=build:

$MSWin10\build\HPEB840G38.txt

HP EliteBook 840 G3 barcoded PC117860 (labelled BC PNB 18 by last owner) = HPEB840G38
(jnbh@live.co.uk)
# build - parallel
Gestionnaire de périphériques > Cartes graphiques > Intel(R) HD Graphics 520
  double-clicked to discover  Pilote > 31.0.101.2111
waiting: Pansies
## AltSnap
winget add altsnap
  APS> schtasks /create /f /tn "AltSnap onlogon" /tr "$Env:AppData\AltSnap\AltSnap.exe" /sc onlogon /rl highest
  PS> $ASi="~\AppData\Roaming\AltSnap\AltSnap.ini"; (gc $ASi).replace('AutoSnap=2','AutoSnap=0') | seco -encoding utf8 $ASi
rebooted to get it working
## Bulk Rename
winget add BulkRenameUtility
## code-minimap
cpi $ITscc\forMSWin\code-minimap-v0.6.7-x86_64-pc-windows-msvc\code-minimap.exe $HADL\Microsoft\WindowsApps
## Disk Usage
cpi "$ITscc\forMSWin\Disk Usage\du64.exe" $HADL\Microsoft\WindowsApps
du64 -l 1  to accept the license
## Edge
see  $ITsCP/networking/browsers/browsers.txt
## Everything
winget add voidtools.Everything
Ctrl+P ( = Tools > Options ) > General >
  UI > [ Démarrer sur un clic simple > on  Résultats >
    Autoriser le clic double dans la colonne des chemin ]
  Polices and couleurs >
    Couleur d'avant plan > Personnalisé > selected a white
    Couleur d'arrière plan > Personnalisé > selected a olive
## File Explorer
Affichage > Options > Affichage >
  [ Afficher l'icône des fichiers sur les miniatures  Afficher la barre d'état ] off-ticked
  Afficher le chemin d'accès complet dans la barre de titre  on-ticked
  Afficher les fichiers, dossier et lecteurs cachés
  [ Masquer les extensions des fichiers dont le type est connu
    Masquer les fichier protégés du système d'exploitation ] off-ticked
## fix ; at end of path
$oldPathCU = (gp hkcu:environment).path; $oldPathCU
$newPathCU = $oldPathCU -replace ';$', ''; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
## fonts - Architects Daughter
for  $Csst/data-1-sorted/counts.tex
sl $ITscc\forMSWin\fonts-FontSquirrel\architects-daughter
  right-clicked on  ArchitectsDaughter.ttf  to  Installer
## fonts DejaVu
$ITscc\forMSWin\fonts-dejavu-fonts-ttf-2.37\ttf > selected all, right clicked on to Install
  arrived in  $HADL\Microsoft\Windows\Fonts
## fonts for Pandoc - Noto Sans CJK Regulars
$coreIT\copied-code\forMSWin\fonts-NotoHinted
MSWin\fonts-copied\NotoHinted > selected all, right clicked on to Install
  arrived in  $HADL\Microsoft\Windows\Fonts
## Gestionnaire de tâches
ctrl+shift+esc > Plus de détails > Options > Masquer l'icône réduite
hidden icon dragged to taskbar
## Opera
winget add XP8CF6S8G2D5T6 > y
## Paramètres
Comptes > Famille et autres utilisateurs > [ deauram@outlook.com  jharrio@outlook.com ] >
  Autoriser
Personnalisation > [ Arrière-plan > Couleur unie
  Barre des tâches > Combiner les boutons de la barre des tâches > Jamais
  Couleurs > Choisir votre mode d'application par défaut > Sombre ]
### Options d'ergonomie
Clavier > all off
Périphériques > Saisie > Orthographie >
  Corriger automatiquement les fautes d'orthograpie > Désactvé
### Système
Alimentation et mise en veille > Jamais, Jamais, 10 minutes, Jamais
  Paramètres d'alimentation supplémentaire >
    Choisir l'action des boutons d'alimentation >
    [ Modifier des paramètres actuellement non disponibles >
    Activer le démarrage rapide  off-ticked  Lorsque je referme le capot > Sur secteur >
      Ne rien faire ]
Écran > Mise à l'échelle et disposition >
  Éclairage nocturne > Activé
  Modifier la taille du texte des applications et d'autres éléments > 100%
  Résolution de l'écran > 1920 x 1080 (recommandé)
Multitâche > Alt + Tab > Uniquement les fenêtres ouvertes
Stockage (L'Assistant de stockage) > Activé
## PDFtk
winget add PDFLabs.PDFtk.Free
## Process Explorer
start $ITscc\forMSWin\ProcessExplorer\procexp64.exe > Agree
  alt+o (= Options) > i (= Tray Icons) > p (= Physical Memory History)
  alt+o (= Options) > h (= Hide When Minimized)
  alt+o (= Options) > l (= Run At Logon)
## Signal
winget add OpenWhisperSystems.Signal
# build - sequential build
Paramètres >
  Mise à jour et sécurité > Activation > Windows est activé à l'aide d'une license numérique
  Système > À propos de > Spécifications de Windows > Windows 10 Pro 21H2 OS build 19044.1889
connected to  Jo-X10II
win+i > Comptes > Famille et autres utilisateurs > Ajouter > jnbh@live.co.uk > Supprimer
win+i > Comptes > Famille et autres utilisateurs > Se connecter via un compte Microsoft >
  jnbh@live.co.uk  6 digit code sent to jharr@ftml.net
  then  compte Utilisateur'd somehow disappeared
  confirmed  jharr@ftml.net  for another 6 digit code
  Créer un code confidentiel > Inclure des lettre > cc
clic droit sur  barre des tâches > Rechercher > Afficher l'icône
Menu > [ Disnéy  Microsoft 365 ] > clic droit > Désintaller
Menu > Système Windows >
  [ Invite de Commandes  Outils d'administration  Panneau de configuration ] > Pinned to Start
## Ditto Clipboard
Microsoft Store > Ditto Clipboard > Install > Pin to Start
Ran it for  Options > General > [ Maximum Number of Saved Copies > 5000
  Advanced > Show leading whitespace ] ( $HADL\Ditto_WindowsApp\Ditto.db )
  Keyboard Shortcuts > Activate Ditto > ctrl+*
## Windows Update
## fitted  BX500
Gestion de disques > clic droit sur  Disque 0 >
  Initialiser le disque (Partition GPT (GUID Partition Table)
  clic droit sur  465.75 Go Non alloué > Nouveau volume simple... > Suivant > D: > BX500
## dropbox.com
Signed in > DropboxInstaller.exe > English & Selective sync
## AWPS
clic droit sur toolbar pour  Propriétés > Couleurs > Opacité > 86%
## PowerShell
winget add Microsoft.PowerShell
## BitLocker
File Explorer on Ce PC was showing a padlock and yellow warning triangle on C:
AIdc> manage-bde -status  then  manage-bde -off c:
  rebooted then after a while the triangle was gone
## WPS execution policy
Get-ExecutionPolicy   reported  "Restricted"
### Administrateur PowerShell
Get-ExecutionPolicy -list  reported all as  "Undefined"
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser -Confirm > o > o
## PSProfile.ps1
sl $MSWin10\mb  for
  WPS> . neededNodes-0-PSProfileStub.ps1
  AWPS> . neededNodes-1-PSProfile.ps1
## WPS modules
AWPS> . modules.ps1 (tweaked) > (fournisseur Nuget) o
## Nom de l'appareil
Paramètres > Système > À propos de > (Nom de l'appareil > DESKTOP-GSPV6OJ)
  Renommer ce PC > HPEB840G38 > Redemarrer
## fail to rename user directory
it's  C:\Utilisateurs\Utilisateur, which is obviously crap
AIdc > wmic useraccount list full  shows the situation
AIdc > cd c:\users  for  rename Utilisateur jnbh  gets  Accès refusé...
## log in as jharrio to fix user directory
PW > Créer un code confidentiel > as per  HPEB840G37  then took a while to "prepare" >
  Sauvegarder vos fichiers avec OneDrive > Ne pas > Suivant > Refuser Microsoft 365 > Refuser
  authorised the spying stuff then Edge too
In File Explorer, renamed  C:\Utilisateurs\Utilisateur  to  jnbh  then couldn`t login as  jnbh
Menu > Système Windows >
  [ Invite de Commandes  Outils d'administration  Panneau de configuration ] > Pinned to Start
Paramètres > Système > Écran > [ Éclairage nocturne > Activé  Mise à l'échelle et disposition >
    Modifier la taille du texte des applications et d'autres éléments > 100% ]
AWPS > rnlu Utilisateur jnbh  but login as  jnbh  still got  Préparation de Windows,
  and again couldn't login...
as jharrio: regedit > HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS NT\CurrentVersion\ProfileList\S-1-5-21-3441228617-810572567-2332938472-1001.bak > ProfileImagePath
  (was  C:\Utilisateurs\Utilisateur) >
  C:\Utilisateurs\jnbh  - showed up immediately in  AIdc > wmic useraccount list full
## log in as jnbh
Snags:
  Ditto  empty
  Dropbox PermissionError WinError 5 Accès refusé C:\\Utilisateurs\\Utilisateur
winget update --all  successfully brought in some big package updates
## Dropbox fix
Paramètres > Applications > Dropbox > Désinstaller
then  dropbox.com  for  Install  then  Selective sync  for just a few
renamed  D:\Dropbox  to  D:\Dr  then  moved  Dropbox  to  D:\
briefly quit Dropbox for  robocopy /mir D:\Dr\conflicted D:\Dropbox\conflicted
paused to include my  Cop  selection and pull those over from  D:\Dr,  restarted and waited
## gVim v9.1.0
winget add vim.vim -l C:\Vim
## neededNodes-2
APS> . $MSWin10\mb\neededNodes-2.ps1
## Git
winget add git.git -l C:\Git
## AutoHotkey
winget add AutoHotkey.AutoHotkey
Shortcut to  $MSWin10\AutoHotkey\1920x1080.ahk
  "$Env:AppData\Microsoft\Windows\Start Menu\Programs\Startup"
## fzf from winget
winget add fzf  then  where.exe fzf  reports  C:\Users\jnbh\AppData\Local\Microsoft\WinGet\Packages\junegunn.fzf_Microsoft.Winget.Source_8wekyb3d8bbwe\fzf.exe
### not working
rebooted for  fzf.vim  to work only occasionally, still not found by  PSFzf
$HADL\Microsoft\WinGet\Links  remains unpopulated...
## WT
winget add 9N0DX20HK701 > y
chcp  reports  CodePage 850
ctrl+, (= Settings)
  Actions > Basculer en mode plein écran > binned
  Azure Cloud Shell > Hide profile from dropdown > On > Save
  Interaction > Warn when closing more than one tab > Off
  PowerShell >
    Appearance > [ Text > Font size > 9  Transparency > Background opacity > 79% ] > Save
    Starting directory >
      (%USERPROFILE%, opening at launch on  C\:Users\jharr, then subequently on  C\:Users\jhbh) .
      still opening at launch on  C\:Users\jharr
      - way later realised this was set in  $MSWin10\AutoHotkey\1920x1080.ahk
  Windows PowerShell > Appearance >
    [ Text > Font size > 9  Transparency > Background opacity > 82% ] > Save
$HADL\Packages\Microsoft.WindowsTerminal_8wekyb3d8bbwe\LocalState\settings.json
## 7-Zip
winget add 7zip.7zip
## WPS modules
they're in  $CPF\WindowsPowerShell\Modules  and  PSFzf  ain't working, so  rmo PSFzf  found nothing
$env:psmodulepath -split (';')
  C:\Users\jnbh\Documents\WindowsPowerShell\Modules
  C:\Program Files\WindowsPowerShell\Modules
  C:\Windows\system32\WindowsPowerShell\v1.0\Modules
## fix OneDrive
Paramètres > Mise à jour et sécurité > Sécurité Windows > Protection contre les virus et menaces >
  Protection contre les ransomware > Configurer OneDrive > jnbh@live.co.uk >
  Impossible de trouver votre dossier OneDrive dans  C:\Users\Utilisateur\OneDrive > Configurer >
  jnbh@live.co.uk > (C:\Users\jnbh\OneDrive) Suivant > (Il y a déjà...) Utiliser >
  Sauvegarder des fichiers > all off > Suivant > OneDrive > Plus tard > Suivant
## PS modules
accidentally  inmo PSFzf
## WPS module PSFzf
md C:\Users\jnbh\Documents\WindowsPowerShell\Modules
inmo PSFzf
  FullyQualifiedErrorId : InstallModuleNeedsCurrentUserScopeParameterForNonAdminUser,Install-Module
File Explorer > C:\Program Files\WindowsPowerShell\Modules  and Deleted  BurntToast, Microsoft.PowerShell.PSResourceGet, posh-git, PowerColorLS, Powershell.Chunks, ps.checkModuleUpdates, PSFzf, PSScriptTools, PSWriteColor, Recycle, Terminal-Icons, ThreadJob, ZLocation
inmo PSFzf -scope currentuser  got it working, but would need to install subsequent modules thus
## re-install Windows
because too many annoying artefacts from  C:\Utilisateurs\Utilisateur
booted to  Windows 10 2022 Update Version 22H2  on  KDTG311281 > (Français (France)...) >
  Suivant > Installer maintenant > Personnalisé > j'accepte >
  Lecteur 1 Partition 3 (119.1 Go) > Supprimer > Nouveau > Taille > 121987 Mo > Appliquer >
  Suivant (let it work) > (France) > Oui > (Français) Oui > Ajouter une disposition >
  Anglais étendu (Royaume-Uni) > Ajouter > Jo-OPPO-A76 > pw > Suivant >
  utilisation personnelle > Suivant > jnbh@live.co.uk > Suivant > single-use code from Fastmail >
  PIN > Accepter... > OneDrive > Ne pas sauvegarder mes fichiers >
  Refuser Microsoft 365 > Refuser > Cortana > Pas maintenant (let it work)
Windows Update for loads
Paramètres all set to my liking again, and tools pulled over
Menu > [ Office  Linkedin  ] > clic droit > Désintaller
## Nom de l'appareil
Paramètres > Système > À propos de > (Nom de l'appareil > DESKTOP-JU8CT53)
  Renommer ce PC > HPEB840G38 > Redemarrer
## Ditto Clipboard
Microsoft Store > Ditto Clipboard > Obtenir > Pin to Start
Ran it for  Options > General > [ Maximum Number of Saved Copies > 5000
  Advanced > Show leading whitespace ] ( $HADL\Ditto_WindowsApp\Ditto.db )
  Keyboard Shortcuts > Activate Ditto > ctrl+*
## driver Updates
Windows Update > [ Mise à jour facultatives > Mise à jour du pilote > HP Inc Firmware 1.57.0.0
  Intel Ports 2316.5.0.0  INTEL System 10.1.1.11  INTEL System 10.1.1.40
  SunplusIT Camera 3.7.8.2  Synaptics Mouse 19.0.19.73 ] > Redemarrer (Updating BIOS 1.57,
  auto-rebooted for Final step of BIOS update)
## dropbox.com
Signed in, D:\Dropbox renamed for  DropboxInstaller.exe > English & Selective sync
  Old folder took the big blue icon away with it...
## WPS
clic droit sur toolbar pour  Propriétés > Couleurs > Opacité > 86%
### execution policy
Get-ExecutionPolicy   reported  "Restricted"
Get-ExecutionPolicy -list  reported all as  "Undefined"
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser -Confirm > o > o
## WPM
winget update --all > y
## PowerShell
winget add Microsoft.PowerShell
## PSProfile.ps1
sl $MSWin10\mb  for
  WPS> . neededNodes-0-PSProfileStub.ps1
  AWPS> . neededNodes-1-PSProfile.ps1
## WPS modules
AWPS> . modules.ps1 (tweaked) > (fournisseur Nuget) o
## fzf from winget
winget add fzf  then  where.exe fzf  reports  C:\Users\jnbh\AppData\Local\Microsoft\WinGet\Packages\junegunn.fzf_Microsoft.Winget.Source_8wekyb3d8bbwe\fzf.exe
## gVim v9.1.0514
winget add vim.vim -l C:\Vim
## neededNodes-2
AWPS> . $MSWin10\mb\neededNodes-2.ps1
## Git
winget add git.git -l C:\Git
## AutoHotkey
winget add AutoHotkey.AutoHotkey
Shortcut to  $MSWin10\AutoHotkey\1920x1080.ahk  moved into
  "$Env:AppData\Microsoft\Windows\Start Menu\Programs\Startup"
## 7-Zip
winget add 7zip.7zip  arrived in  $CPF\7-Zip, and not in path...
## Dropbox
D:\Dropbox  somehow recovered its big blue icon
### DokuWiki dubious ownership
$DWp> git grep Everything
  fatal: detected dubious ownership in repository at 'D:/Dropbox/JH/core/IT_stack/DokuWiki'
  'D:/Dropbox/JH/core/IT_stack/DokuWiki' is owned by:
    (inconvertible) (S-1-5-21-3441228617-810572567-2332938472-1001)
  but the current user is:
    HPEB840G38/jnbh (S-1-5-21-332200848-1951021372-1013214746-1001)
  To add an exception for this directory, call:
    git config --global --add safe.directory D:/Dropbox/JH/core/IT_stack/DokuWiki
#### fix
EdF > $coreIT > DokuWiki > Propriétés > Sécurité > Avancé > Modifier > Avancé > Rechercher > jnbh Jo (jnbh@live.co.uk) > OK > OK > Remplacer le propiétaires des sous-conteneurs et des objets  on-ticked > OK > OK
## 7-Zip fixed
& $CPF\7-Zip\7z.exe  is clumsy, so  winget rm 7zip.7zip  for  winget add 7zip.7zip -l C:\7-Zip
### add to path
fixed ; at end of path
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = "$oldPathCU;C:\7-Zip"; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
rebooted to get  7z  working in  WPS
## GitHub keys
sl $Enc  to extract  actions.ps1  to extract  $Enc\Secure1  for
  & $MSWin10\mb\neededNodes-3-GitHubKeys.ps1
## WT
winget add 9N0DX20HK701 > y
## switched to  $MSWin10\AutoHotkey\HPEB840G38.ahk
Which would've obviated my need to reinstall Windows...
## WT configure
chcp  reports  CodePage 850
ctrl+, (= Paramètres)
  Azure Cloud Shell > Masquez le profil de la liste déroulante > Activé
  Interaction > M'avertir lorsque je ferme plusieurs onglets  off-slid
  PowerShell > Répertoire de démarrage > . > Apparence >
    [ Text > Taille de police > 9  Transparence > Opacité de l'arrière plan > 83% ] > Enregistrer
  Windows PowerShell > Répertoire de démarrage > . > Apparence >
    [ Text > Taille de police > 9  Transparence > Opacité de l'arrière plan > 84% ] > Enregistrer
$HADL\Packages\Microsoft.WindowsTerminal_8wekyb3d8bbwe\LocalState\settings.json
## PS modules
PS> & $MSWin10\mb\modules.ps1 (tweaked)
## Git Bash
  WARNING: Found ~/.bashrc but no ~/.bash_profile, ~/.bash_login or ~/.profile.
  This looks like an incorrect setup.
  A ~/.bash_profile that loads ~/.bashrc will be created for you.
### obligatory test of GitHub SSH connection
ssh -T git@github.com
  The authenticity of host 'github.com (64:ff9b::8c52:7903)' can't be established.
  ED25519 key fingerprint is SHA256:+DiY3wvvV6TuJJhbpZisF/zLDA0zPMSvHdkr4UvCOqU.
  This key is not known by any other names.
  Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
  Warning: Permanently added 'github.com' (ED25519) to the list of known hosts.
  Hi harriott! You've successfully authenticated, but GitHub does not provide shell access.
got me  $HOME\.ssh\known_hosts
## LSD
winget add lsd
fixed ; at end of path
## BgInfo
winget add BgInfo
fixed ; at end of path
BgInfo > Agree
ran it, font down to 8 and Grey 50%, positioned top right
## sharkdp.fd
winget add sharkdp.fd
fixed ; at end of path
## unwanted HP Hotkey Support popup
empty popup appearing each time I try to change the screen brightness
Services > HP Hotkey UWP Service > Type de démarrage > (was Automatique) Désactivé
rebooted
## gokcehan's lf
winget add gokcehan.lf
fixed ; at end of path
## Edge
annoying reconfigure process
F12 (= DevTools) to clear away question
## Neovim
winget add Neovim.Neovim  rebooted to get  nvim  working
## $MSWin10 ownership
APS> takeown /f $MSWin10 /r /d o
## CMake
winget add Kitware.CMake
## Visual Studio Build Tools 2022 to make  telescope-fzf-native.nvim
winget add Microsoft.VisualStudio.2022.BuildTools
## $vimfiles ownership
APS> takeown /f $vimfiles /r /d o
## $OSAB ownership
APS> takeown /f $OSAB /r /d o
## KeePassXC
winget add KeePassXCTeam.KeePassXC
ran it for  Oui > Ouvrir une base de données > D:\Dropbox\JH\core\encrypted\JH.kdbx
ctrl+, (= Outils > Paramètres) > [
  Général > Démarrage > Lancer automatiquement KeePassXC au démarrage du système  off
  Intégration aux navigateurs > Activer > Edge ]
restarted Edge > HPEB840G38-Edge
## LibreOffice
winget add libreoffice
ran it to build  ~\AppData\Roaming\LibreOffice\4
$MSWin10\build\LibreOfficeConfig.ps1
## Python 3.12
winget add python.python.3.12
got it to  C:\Users\jnbh\AppData\Local\Programs\Python\Python312\python.exe
new instance of PowerShell for  py -V
## Rust for ripgrep
(once Visual Studio components) winget add rustup
## Idc > Propriétés
Coleurs > 86%  Police > 14
## ripgrep
(once Rust) winget add burntsushi.ripgrep.msvc
fixed ; at end of path
## Lua
cp D:\Dropbox\JH\core\IT_stack\copied-code\forMSWin\LuaBinaries\lua-5.4.2_Win64_bin C:\Lua -recurse
### add to path
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = "$oldPathCU;C:\Lua"; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
(new PowerShell instance) lua54 -v
### LuaRocks
cp D:\Dropbox\JH\core\IT_stack\copied-code\forMSWin\luarocks-3.11.1-windows-64\* C:\Lua
## Zig
(for  tree-sitter) winget add zig.zig  took ages to unpack
fixed ; at end of path
zig version
## eza
winget add eza-community.eza
fixed ; at end of path
## Sumatra PDF
winget add SumatraPDF -h -l C:\SumatraPDF
## Node.js
winget add OpenJS.NodeJS
Node.js  icon pulled over to Start Menu, run for (right-click) console.log('Hello')
  ls $CPF\nodejs\node.exe
  $CPF\nodejs\node_modules\corepack\README.md
  $CPF\nodejs\node_modules\npm\README.md
(new PS) npm prefix -g  reports  C:\Users\jnbh\AppData\Roaming\npm
npm ls -g  reports what's in  $HADR\npm
## Node.js - npx
npx cowsay goodbye!
g C:\Users\jnbh\AppData\Local\npm-cache\_npx\8f497369b2d6166e\node_modules
g $HADL\npm-cache\_npx\8f497369b2d6166e\node_modules  surprisingly populated
## Neovide
winget add neovide -l C:\Vim  but it went to  $CPF\Neovide\neovide.exe
## Google Chrome
winget add Google.Chrome.EXE
## $ITsCP ownership
APS> takeown /f $ITsCP /r /d o
## FastStone Image Viewer
winget add FastStone.Viewer  "C:\Program Files (x86)\FastStone Image Viewer\FSViewer.exe"
ran it for Esc to offtick
f12 (= Paramètres) > Aperçu > [
  En boucle  Rotation Auto par tag orientation EXIF > off  Confirmer la reéctirure des fichiers
  Lancer les images associées > dans une Fenêtre  Unité par défaut > cm ]
$HADL\FastStone\FSIV\FSSettings.db
## $TeNo ownership
APS> takeown /f $TeNo /r /d o
## brightness
fn+echap, fn+f5/f6  not working
### BIOS update
sp152405.exe (unpacked to  C:\SWSetup\SP152405) > Sauvegarde > Suivant >
  (C:\SWSetup\SP152405  changed to) D:\SWSetup-SP152405-backup, which had to be made > Suivant
  (got me  N75_0157.bin)
sp152405.exe (unpacked again to  C:\SWSetup\SP152405) > Mise à jour > Suivant > Redémarrer >
  System BIOS Update  took a while then rebooted to  System BIOS Update  again, then rebooted
appeared in  Gestionnaire de périphériques > Microprogrammes
fn+echap, fn+f5/f6  still not working
## PowerShell v7.4.0
PowerShell-7.4.4-win-x64.msi > [ Add 'Open here' context menu to Explorer
  Add 'Run with PowerShell 7' context menu for PowerShell files ] > Next > Next > UAC > Yes
  failed on something not closed enough, so  PowerShell-7.4.4-win-x64.msi > Repair > Repair
## Intel Video Driver and Control Panel System Software Manager 27.20.100.9416 Rev.W
sp115295.exe (unpacked again to  C:\SWSetup\SP115295) >
  Erreur: Ce système d'exploitation n'est pas pris en charge
## Utilitaire et pilote d'installation du chipset Intel System Software Manager
sp101370.exe > Suivant > Suivant (unpacked to  C:\SWSetup\SP101370)
  "HP Softpaq Wrapper Completed" > Terminer
precautionary reboot, then  C:\SWSetup\SP101370\InstallCmdWrapper.exe  achieved nothing...
## Assistance relative aux raccourcis clavier HP - UWP System Software Manager
sp140913.exe (unpacked to  C:\SWSetup\SP140913)
## Intel Serial IO Driver System Software Manager 30.100.1724.2 Rev.A
sp82020.exe (unpacked to  C:\SWSETUP\SP82020)
## Mises à jour système essentielles System Software Manager 11.4 Rev.2
sp101974.exe (unpacked to  C:\SWSetup\SP101974) > ... > redémarré
## pip v24.1.2
pip list  advises  py -m pip install -U pip
## pipx
py -m pip install --user pipx
  Installing collected packages: platformdirs, packaging, colorama, argcomplete, click, userpath, pipx
    WARNING: The script userpath.exe is installed in 'C:\Users\jnbh\AppData\Roaming\Python\Python312\Scripts' which is not on PATH.
    Consider adding this directory to PATH or, if you prefer to suppress this warning, use --no-warn-script-location.
    WARNING: The script pipx.exe is installed in 'C:\Users\jnbh\AppData\Roaming\Python\Python312\Scripts' which is not on PATH.
    Consider adding this directory to PATH or, if you prefer to suppress this warning, use --no-warn-script-location.
  Successfully installed argcomplete-3.4.0 click-8.1.7 colorama-0.4.6 packaging-24.1 pipx-1.6.0 platformdirs-4.2.2 userpath-1.9.2
& $HADR\Python\Python312\Scripts\pipx.exe ensurepath
  Success! Added C:\Users\jnbh\AppData\Roaming\Python\Python312\Scripts to the PATH environment variable.
  Success! Added C:\Users\jnbh\.local\bin to the PATH environment variable.
  Consider adding shell completions for pipx. Run 'pipx completions' for instructions.
## pynvim (for neovim)
(needed for python packages)  pip install pynvim
## less-Windows
winget install jftuga.less
fixed ; at end of path
## dubious ownership of $onGH/pandoc-templates
in there, APS> takeown /f . /r /d o
## MiKTeX
winget add miktex  went to  $HADL\Programs\MiKTeX
rebooted for  MiKTeX Console > Check > Updates  for 113
$HADL\MiKTeX  created at some point
sl $jtIT\CP\TeX\distro-MiKTeX\miktex-xetex  for  x mwe  and off_ticked "Always show this dialog"
## Pandoc
after MiKTeX
  headings0sty; miktex fndb refresh
  winget add JohnMacFarlane.Pandoc  got  $HADL\Pandoc\pandoc.exe
    in a new instance of PowerShell,  sl $ITsCP\Pandoc  for
      pandoc --toc --toc-depth=6 -f markdown_strict toCdepth6MWE.md -o toCdepth6MWE.pdf
      - took a while for MiKTeX to download all the necessary packages
## Lecteur Windows Media
Télécharger automatiquement les droits d'utilisation, Historiques  tous décoché
## yt-dlp (and FFmpeg)
winget add yt-dlp.yt-dlp
  Ce package nécessite les dépendances suivantes :
    - Packages
        Gyan.FFmpeg
  (1/1) Trouvé FFmpeg [Gyan.FFmpeg] Version 6.1.1
  ...
  Téléchargement en cours https://github.com/GyanD/codexffmpeg/releases/download/7.0.2/ffmpeg-7.0.2-full_build.zip
  ...
  Installé correctement
  Téléchargement en cours https://github.com/yt-dlp/yt-dlp/releases/download/2024.08.06/yt-dlp.exe
fixed ; at end of path
### FFmpeg
ffmpeg -version
### yt-dlp
yt-dlp --version
## Thunderbird
winget add mozilla.thunderbird -h -l C:\MT
ran it to get  $HADR\Thunderbird\Profiles\yqi3hpui.default-esr
emptied  Profiles
in $HADR\Thunderbird\profiles.ini
  removed [Profile1]
  [Profile0] section:
    Name=default-esr
    IsRelative=0
    Path=D:\Dropbox\JH\Thb-dr
  [Install5CC7CE6A1DCFB43B]
    Default=D:\Dropbox\JH\Thb-dr
    Locked=1
ran it for (default-release) Démarrer Thunderbird
## WSL Ubuntu attempt
winget add Canonical.Ubuntu.2204  rebooted
## WT configure
ctrl+, (= Paramètres)
  Developer Command Prompt for VS 2022 >
    Masquez le profil de la liste déroulante > Activé > Enregistrer
  Developer PowerShell for VS 2022 >
    Masquez le profil de la liste déroulante > Activé > Enregistrer
## WSL Ubuntu
WT > ctrl+' (= Ubuntu tab)
  Installing, this may take a few minutes...
  WslRegisterDistribution failed with error: 0x8007019e
  The Windows Subsystem for Linux optional component is not enabled. Please enable it and try again.
  See https://aka.ms/wslinstall for details.
winget rm Canonical.Ubuntu.2204  rebooted
wsl --install  Redemarré  then installation took a while
UNIX username > jo > pw
touch ~/.hushlogin
sudo apt update  reported 119 so  ...
sudo apt upgrade
WT > ctrl+, > Ubuntu Apparance >
  Jeu de couleurs > One Half Dark
  Texte > Taille de police > 9
  Transparence > Opacité de l'arrière plan > 86%
$ lsb_release -a  reports  Ubuntu 22.04.4 LTS
## WT Ubuntu received settings
Ubuntu
  Icône > https://assets.ubuntu.com/v1/49a1a858-favicon-32x32.png - the one that shows in use
  Ligne de commande > ubuntu.exe
  Masquez le profil de la liste déroulante > Désactivé
Ubuntu
  Icône > ms-appx:///ProfileIcons/{9acb9455-ca41-5af7-950f-6bca1bc9722f}.png
  Ligne de commande > C:\Windows\system32\wsl.exe -d Ubuntu
  Masquez le profil de la liste déroulante > Activé
## WSL Ubuntu Bash configuration
$MSn/set/5-WSL-Bash.sh
## WSL Ubuntu version
PS> wsl -l -o  shows  Ubuntu-24.04, but  $ lsb_release -a  reports  Ubuntu 22.04.4 LTS
## WSL Ubuntu upgrades
sudo apt update && sudo apt upgrade
  The following packages have been kept back:
    e2fsprogs libcom-err2 libext2fs2 libss2 logsave python3-update-manager update-manager-core
## WSL Ubuntu plocate
sudo apt install plocate  then took ages to initialize the database
sudo cp $MSWSL/updatedb.conf /etc/updatedb.conf  then  sudo updatedb
## WSL Ubuntu packages
sudo apt install fd-find fzf highlight neofetch nnn p7zip-full ranger ripgrep tmux
sudo snap install jump  # Samokovarov's
## ExifTool v12.93
cpi "$ITscc\forMSWin\exiftool-12_93_64\exiftool(-k).exe" $HADL\Microsoft\WindowsApps\exiftool.exe
cpi -recurse $ITscc\forMSWin\exiftool-12_93_64\exiftool_files $HADL\Microsoft\WindowsApps
## HP Smart
winget add 9WZDNCRFHWLH > y
Se connecter  found  HPA22F0E (ENVY 5530)
## WSL Ubuntu upgrades
sudo apt update && sudo apt upgrade
  The following packages have been kept back:
    e2fsprogs libcom-err2 libext2fs2 libss2 logsave python3-update-manager update-manager-core
## WSL Ubuntu bc
sudo apt install bc
## dubious ownership of $Csst
in there, APS> takeown /f . /r /d o
## ExifTool v12.96
cpi "$ITscc\forMSWin\exiftool-12_96_64\exiftool(-k).exe" $HADL\Microsoft\WindowsApps\exiftool.exe
robocopy /mir $ITscc\forMSWin\exiftool-12_96_64\exiftool_files $HADL\Microsoft\WindowsApps\exiftool_files
exiftool -ver
## fix LSD in $PATH
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU+';C:\Users\jnbh\AppData\Local\Microsoft\WinGet\Packages\lsd-rs.lsd_Microsoft.Winget.Source_8wekyb3d8bbwe\lsd-v1.1.5-x86_64-pc-windows-msvc'; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
## fix fd in $PATH
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU+';C:\Users\jnbh\AppData\Local\Microsoft\WinGet\Packages\sharkdp.fd_Microsoft.Winget.Source_8wekyb3d8bbwe\fd-v10.2.0-x86_64-pc-windows-msvc'; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
## fix rg in $PATH
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU+';C:\Users\jnbh\AppData\Local\Microsoft\WinGet\Packages\BurntSushi.ripgrep.MSVC_Microsoft.Winget.Source_8wekyb3d8bbwe\ripgrep-14.1.1-x86_64-pc-windows-msvc'; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
## WSL Ubuntu dos2unix
sudo apt install dos2unix
## WSL Ubuntu wslu
sudo add-apt-repository ppa:wslutilities/wslu
  got me  \\wsl$\Ubuntu\etc\apt\sources.list.d\wslutilities-ubuntu-wslu-jammy.list
sudo apt update
sudo apt install wslu
## sharkdp/bat
also for  fzf
winget add sharkdp.bat
removed ; from end of path
## Dropbox loads of files stuck "Waiting to sync"
Dropbox  exited for  D:\Dropbox\.dropbox.cache  Deleted  then  Dropbox  relaunched
seemed to be mainly Vim plugin files
Dropbox > Preferences > Account > alt+h > [ Fix Hardlinks  Fix Permissions ]
  here and on  i34G1TU02  &  sbMb, no luck
Seem's to've been due to a  git clone https://github.com/dense-analysis/ale  in  $Drpbx/Play0
## dubious ownership of $misc
in there, APS> takeown /f . /r /d o
## WSL Ubuntu trash-cli
sudo apt install trash-cli
## IrfanView
winget add IrfanSkiljan.IrfanView
ran it for  p (= Properties/Settings) > [ JPG > Auto-rotate off  Editing > Cut White ]
winget add IrfanSkiljan.IrfanView.PlugIns
## FastStone Image Viewer
with an image open, e  for  C:\Program Files\IrfanView\i_view64.exe
## VLC Player
winget add VideoLAN.VLC
run for  ctrl+p (= Preferences) > Pause on the last frame of a video > Always
## MediaInfo
winget add MediaArea.MediaInfo
fixed ; at end of path
## BX500 inaccessible
took it out and chkdsk'd from HPEB840G37 - no errors, refitted and all good
## Microsoft.PowerShell.PSResourceGet
APS> inmo microsoft.powershell.psresourceget
  WARNING: Version '1.0.4.1' of module 'Microsoft.PowerShell.PSResourceGet' is already installed at 'C:\program files\powershell\7\Modules\Microsoft.PowerShell.PSResourceGet'. To install version '1.0.6', run Install-Module and add the -Force parameter, this command will install version '1.0.6' side-by-side with version '1.0.4.1'.
it's at  $PSHOME\Modules\Microsoft.PowerShell.PSResourceGet
  which ain't found by  Get-PSResource Microsoft.PowerShell.PSResourceGet
inmo microsoft.powershell.psresourceget -Force
## Python 3.13
winget rm Python.Python.3.12
### remove $HADR\Python\python312\scripts from $PATH
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU -replace 'c:\\users\\jnbh\\appdata\\roaming\\python\\python312\\scripts;',''; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
### Python 3.13
winget add Python.Python.3.13
python -h  show it's in  $HADL\Programs\Python
Deleted  $HADL\Python\Python312
### pipx
py -m pip install --user -U pipx
  [notice] A new release of pip is available: 24.2 -> 24.3.1
  [notice] To update, run: python.exe -m pip install --upgrade pip
#### switch to $HADR\Python\Python313
Deleted  $HADR\Python\Python312
##### add $HADR\Python\Python313 to $PATH
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
(accounting for surplus terminating :) $newPathCU = $oldPathCU+'C:\Users\jnbh\AppData\Roaming\Python\Python313\Scripts'; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
#### test pipx
pipx run pycowsay moo
## IrfanView v4.70
winget update IrfanSkiljan.IrfanView  refused, so  winget rm IrfanSkiljan.IrfanView
winget add IrfanSkiljan.IrfanView  refused, so
Paramètres > Applications > IrfanView > Désinstaller > Désinstaller
winget add IrfanSkiljan.IrfanView
winget add IrfanSkiljan.IrfanView.PlugIns
### find the executable
where.exe IrfanView
### FastStone Image Viewer
opened an image > f12 > Programmes > Supprimer  then  e > Ajout > C:\Users\jnbh\AppData\Local\Microsoft\WinGet\Packages\IrfanSkiljan.IrfanView_Microsoft.Winget.Source_8wekyb3d8bbwe\i_view64.exe
## WSL lsd
sudo snap install lsd
## WSL Ubuntu neomutt neovim
sudo apt install neomutt neovim
## WSL Ubuntu upgrades
sudo apt update && sudo apt upgrade
  ...
  The following packages were automatically installed and are no longer required: htop libnl-3-200 libnl-genl-3-200  Use 'sudo apt autoremove' to remove them.
  Get more security updates through Ubuntu Pro with 'esm-apps' enabled: libheif1 imagemagick liblua5.4-0 libopenexr25 libmagickcore-6.q16-6-extra libmagickwand-6.q16-6 imagemagick-6.q16 libmagickcore-6.q16-6 imagemagick-6-common libde265-0
  The following packages have been kept back: libegl-mesa0 libgbm1 libgl1-mesa-dri libglapi-mesa libglx-mesa0
## WSL Ubuntu Pro
sudo pro attach <FPT>
  Enabling Ubuntu Pro: ESM Apps
  ...
  Enabling Ubuntu Pro: ESM Infra
  ...
  This machine is now attached to 'Ubuntu Pro - free personal subscription'
  SERVICE      ENTITLED STATUS    DESCRIPTION
  anbox-cloud  yes      disabled  Scalable Android in the cloud
  esm-apps     yes      enabled   Expanded Security Maintenance for Applications
  esm-infra    yes      enabled   Expanded Security Maintenance for Infrastructure
  fips-preview yes      disabled  Preview of FIPS crypto packages undergoing certification with NIST
  fips-updates yes      disabled  FIPS compliant crypto packages with stable security updates
  usg          yes      disabled  Security compliance and audit tools
  NOTICES: Operation in progress: pro attach
  For a list of all Ubuntu Pro services, run 'pro status --all'
  Enable services with: pro enable <service>
  Account: trohib@gmail.com
  Subscription: Ubuntu Pro - free personal subscription
## dubious ownership of $MD4PDF
in there, APS> takeown /f . /r /d o
## XpdfReader
XpdfReader-win64-4.05.exe  (C:\Program Files\Glyph & Cog\XpdfReader-win64)
  pdfimages -h
## WSL Ubuntu - .bash_history
cp \\wsl$\Ubuntu\home\jo\.bash_history $MSWml/WSL-bash_history-$((get-date).tostring("yyMMdd-HHmmss")).sh
## WSL Ubuntu remove
closed WT for  Applications et fonctionnalités > Ubuntu > Désinstaller
## WSL Ubuntu 24.04.1 LTS
winget add Canonical.Ubuntu.2404
Windows Menu > Ubuntu 24.04.1 LTS  fired up a new WT & installed it > UNIX username > jo > pw
all WT quit for  WT > ctrl+5 (= Ubuntu 24.04 LTS tab)
## WSL Ubuntu 24.04 update
sudo apt update  reported 182 so  sudo apt upgrade
lsb_release -a  reports  Ubuntu 24.04.1 LTS
## WT Ubuntu 24.04 settings
WT > ctrl+, >
  Git Bash > Masquez le profil de la liste déroulante > Activé
  Ubuntu 24.04 Apparance >
    Jeu de couleurs > One Half Dark
    Texte > Taille de police > 9
    Transparence > Opacité de l'arrière plan > 77%
## WT Ubuntu 24.04 received settings
Ubuntu 24.04 LTS
  Icône > https://assets.ubuntu.com/v1/49a1a858-favicon-32x32.png - the one that shows in use
  Ligne de commande > ubuntu2404.exe
  Masquez le profil de la liste déroulante > Désactivé
Ubuntu 24.04
  Icône > ms-appx:///ProfileIcons/{9acb9455-ca41-5af7-950f-6bca1bc9722f}.png
  Ligne de commande > C:\Windows\system32\wsl.exe -d Ubuntu-24.04
  Masquez le profil de la liste déroulante > Activé
## WSL Ubuntu 24.04 Bash configuration
$MSn/set/5-WSL-Bash.sh
## WSL Ubuntu 24.04 packages
sudo apt install bc dos2unix fd-find fzf highlight isync ncdu neofetch neomutt neovim nnn notmuch pass p7zip-full ranger ripgrep tmux trash-cli
## WSL Ubuntu 24.04 snaps
sudo snap install jump lsd  # Samokovarov's jump
## WSL Ubuntu 24.04 plocate
sudo apt install plocate  then took ages to initialize the database
sudo cp $MSn/WSL/updatedb.conf /etc/updatedb.conf  then  sudo updatedb  (much faster)
## WSL Ubuntu 24.04 nodes
. $MSn/set/6-WSL-nodes.sh
## WSL Ubuntu 24.04 wslu
sudo add-apt-repository ppa:wslutilities/wslu
  got me  \\wsl$\Ubuntu-24.04\etc\apt\sources.list.d\wslutilities-ubuntu-wslu-noble.sources
sudo apt update
sudo apt install wslu
## WSL Ubuntu 24.04 GnuPG keys
gpg -k
  gpg: directory '/home/jo/.gnupg' created
  gpg: keybox '/home/jo/.gnupg/pubring.kbx' created
  gpg: /home/jo/.gnupg/trustdb.gpg: trustdb created
in  $Enc/Secure1/GnuPG/13F327EF,  gpg --import sprbMbArch-ob8-private.asc > passphrase
  gpg: key 842A4DEE13F327EF: public key "Joseph Harriott (sprbMb Arch) <jharr@ftml.net>" imported
  gpg: key 842A4DEE13F327EF: secret key imported
## WSL Ubuntu 24.04 password-store
rsync -irtv --delete $Enc/Secure1/password-store/ ~/.password-store
## WSL Ubuntu 24.04 Pro
sudo pro attach <FPT>
[sudo] password for jo:
  Enabling Ubuntu Pro: ESM Apps
  ...
  Enabling Ubuntu Pro: ESM Infra
  ...
  This machine is now attached to 'Ubuntu Pro - free personal subscription'
  SERVICE          ENTITLED  STATUS       DESCRIPTION
  anbox-cloud      yes       disabled     Scalable Android in the cloud
  esm-apps         yes       enabled      Expanded Security Maintenance for Applications
  esm-infra        yes       enabled      Expanded Security Maintenance for Infrastructure
  landscape        yes       disabled     Management and administration tool for Ubuntu
  NOTICES: Operation in progress: pro attach
  For a list of all Ubuntu Pro services, run 'pro status --all'
  Enable services with: pro enable <service>
  Account: trohib@gmail.com
  Subscription: Ubuntu Pro - free personal subscription
sudo apt update
sudo apt upgrade
  The following upgrades have been deferred due to phasing:
    python3-distupgrade ubuntu-release-upgrader-core
## WSL Ubuntu 24.04 libdata-printer-perl
(for  Data::Printer  in  $clMail/notmuch/nmsh-sort.pl) sudo apt install libdata-printer-perl
## Ce PC disk space usage bar
disappeared, so  Affichage > Options > Affichage > Réinitialer les dossiers
## DVDFab
dvdfab13_online_13034.exe   took a long time to install,
  (leaving  ~\Downloads\DVDFab\DVDFab13\DVDFab 13(13.0.3.4).exe) then run
  Autoriser > trohib@gmail.com + pw > dvdfab.cn > Deauthorized  T430i73520M  install
  DVDFab > Ne plus afficher > closed for > (Quitter) Ne plus afficher
## DVD Shrink
dvdshrink32setup.exe  ran it
## VLC speed
+ not working so  ctrl+p > Raccourcis > Accélérer > )
## mpv
cpi $ITscc/forMSWin/AV/mpv-x86_64-20250113-git-ca211b5/mpv.exe $HADL\Microsoft\WindowsApps
## FFmpeg back into $PATH
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU+';C:\Users\jnbh\AppData\Local\Microsoft\WinGet\Packages\Gyan.FFmpeg_Microsoft.Winget.Source_8wekyb3d8bbwe\ffmpeg-7.1-full_build\bin\ffplay.exe'; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
### not play
new PowerShell
  $oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
  $newPathCU = $oldPathCU -replace 'play', 'mpeg'; $newPathCU
  sp 'registry::hkcu\environment' -name path -value $newPathCU
  new PowerShell
### not ffmpeg.exe
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU -replace '\\ffmpeg.exe', ''; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
new PowerShell
## WT Ubuntu Apparance
WT > ctrl+, > Ubuntu Apparance >
  Jeu de couleurs > One Half Dark
  Texte > Taille de police > 9
  Transparence > Opacité de l'arrière plan > 86%
## BgInfo
& $HADLM\WinGet\Packages\Microsoft.Sysinternals.BGInfo_Microsoft.Winget.Source_8wekyb3d8bbwe\bginfo.exe > OK
## moved to $coreIT
### allow Dropboox to work
ri "$HADR\Microsoft\Windows\Start Menu\Programs\Startup\HPEB840G38.ahk.lnk"
quit  Process Explorer
### resume full functionality
APS> $MSn\set  to run the scripts
shortcut to  $MSn\AutoHotkey\HPEB840G38.ahk
  to  "$HADR\Microsoft\Windows\Start Menu\Programs\Startup"
### Process Explorer
start $ITscc\forMSWin\ProcessExplorer\procexp64.exe
## WSL Ubuntu 24.04
ran the scripts in  $MSn\set
## Thunderbird
old version getting fired up
  Applications et fonctionnalités > Thunderbird > Désinstaller  got rid of  C:\MT
### add to path
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU+';C:\Program Files\Mozilla Thunderbird'; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
## Thunderbird
thunderbird  to get  $HADR\Thunderbird\Profiles\xxxxxxxx.default-esr  then emptied  Profiles
  (cp $HADR\Thunderbird\profiles.ini $MSWml\Thunderbird-profiles-p1o.ini)
cp $MSn\Thb\profiles.ini $HADR\Thunderbird\profiles.ini
ran it for (default-esr) Démarrer Thunderbird)
## WSL Ubuntu 24.04 internet
not connecting via  cafezoide pro
## Ookla Speedtest
speedtestby  -_x64.msi
## Process Explorer
start $ITscc\forMSWin\ProcessExplorer\procexp64.exe
## LibreOffice Calc printer delay at launch
  Attente de la connexion de l'imprimante
  Attendez la connexion à l'imprimante ou annulez la connexion
I either wait a minute or hit  Annuler, neither good options...
Paramètres > Périphériques > Imprimantes et scanners >
  Laisser Windows gérer mon imprimante par défaut
  Microsoft XPS Document Writer
## csvkit
pipx install csvkit
  installed package csvkit 2.0.1, installed using Python 3.13.1
  These apps are now globally available
    csvclean.exe
    csvcut.exe
    csvformat.exe
    csvgrep.exe
    csvjoin.exe
    csvjson.exe
    csvlook.exe
    csvpy.exe
    csvsort.exe
    csvsql.exe
    csvstack.exe
    csvstat.exe
    in2csv.exe
    sql2csv.exe
## VisiData
pipx install visidata
installed package visidata 3.1.1, installed using Python 3.13.1
  These apps are now globally available
    - vd
    - vd2to3.vdx
    - visidata.exe
  These manual pages are now globally available
    - man1\vd.1
    - man1\visidata.1
vd --version  not working, so  visidata --version
## OdfPy
pipx install odfpy
  installed package odfpy 1.4.1, installed using Python 3.13.1
  These apps are now globally available
    - csv2ods
    - mailodf
    - odf2mht
    - odf2xhtml
    - odf2xml
    - odfimgimport
    - odflint
    - odfmeta
    - odfoutline
    - odfuserfield
    - xml2odf
## Ruby 3.2
winget add RubyInstallerTeam.Ruby.3.2
(in a refreshed Powershell) gem list
## WSL Ubuntu 24.04 Ruby
sudo apt install ruby
## WSL Ubuntu 24.04 libodsstream
sudo apt install libodsstream-dev
## WSL Ubuntu 24.04 Ruby gems for ods2csv
gem install csv
gem install libarchive libxml-ruby
  ...
  mkmf.rb can't find header files for ruby at /usr/lib/ruby/include/ruby.h
  ...
  mkmf.rb can't find header files for ruby at /usr/lib/ruby/include/ruby.h
## WSL Ubuntu 24.04 Ruby
sudo apt install ruby-dev
## WSL Ubuntu 24.04 Ruby gems for ods2csv
gem install libarchive libxml-ruby
  ...
  ERROR: Failed to build gem native extension.
  ...
  ERROR: Failed to build gem native extension.
## WSL Ubuntu remove
sl \\wsl$\Ubuntu  shows it's all still there, so  wsl --unregister Ubuntu
## WSL Ubuntu 24.04 rename mess
Win+r > regedit > HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Lxss > {...} >
  DistributionName > Ubuntu
WT > ctrl+, > Ubuntu 24.04.1 LTS >
  Lgine de commande > ubuntu2404.exe
  Nom > (Ubuntu 24.04.1 LTS) Ubuntu
  Titre > (Ubuntu 24.04.1 LTS) Ubuntu
WT lost access to Ubuntu, though  wsl -d Ubuntu  works
Can't run Ubuntu from Start Menu...
## WSL Ubuntu 24.04.1 LTS reregister
cp \\wsl$\Ubuntu\home\jo\.bash_history $MSWml/WSL-bash_history-$((get-date).tostring("yyMMdd-HHmmss")).sh
wsl --unregister Ubuntu
Start Menu > Ubuntu 24.04.1 LTS  fired up a new WT & installed it > UNIX username > jo > pw
all WT quit for  WT > ctrl+'  recovered my WT Ubuntu settings, but tab title still Ubuntu 24.04.1 LTS
$MSn/set/5-WSL-Bash.sh
$MSn/set/6-WSL-nodes.sh
sudo apt update  reported 84 so  sudo apt upgrade
## WSL Ubuntu 24.04.1 LTS packages
sudo apt install bc dos2unix fd-find fzf highlight isync ncdu neofetch neomutt neovim nnn notmuch pass p7zip-full ranger ripgrep tmux trash-cli
## WSL Ubuntu 24.04.1 LTS snaps
sudo snap install jump lsd  # Samokovarov's jump
## WSL Ubuntu 24.04.1 LTS plocate
sudo cp $MSn/WSL/updatedb.conf /etc/updatedb.conf  for  sudo apt install plocate
## WSL Ubuntu 24.04.1 LTS wslu
sudo add-apt-repository ppa:wslutilities/wslu
  got me  \\wsl$\Ubuntu-24.04\etc\apt\sources.list.d\wslutilities-ubuntu-wslu-noble.sources
sudo apt update
sudo apt install wslu
## WSL Ubuntu 24.04.1 LTS password-store
rsync -irtv --delete $Enc/Secure1/password-store/ ~/.password-store
## WSL Ubuntu 24.04.1 LTS Pro
sudo pro attach <FPT>
sudo apt update
sudo apt upgrade
## WSL Ubuntu 24.04.1 LTS libdata-printer-perl
(for  Data::Printer  in  $clMail/notmuch/nmsh-sort.pl) sudo apt install libdata-printer-perl
## WSL Ubuntu 24.04.1 LTS libodsstream
sudo apt install libodsstream-dev
sudo apt remove libodsstream-dev
## WSL Ubuntu 24.04.1 LTS ods2tsv
sudo apt install ods2tsv
sudo apt autoremove
## Dropbox 217.4.4417.0
needed to Sign in again, though it remembered my preferences
  There's already a folder or file named Dropbox
so had to quit  AutoHotkey  script, and  Process Explorer
  to be able to rename  D:\Dropbox  to  D:\Dropbo
  so's I could get going again with  D:\Dropbox
  which I immediately quit to copy over all of  D:\Dropbo  except  .dropbox  $  .dropbox.cache
  then relaunched  Dropbox, getting a full re-indexation
## Epson EcoTank ET-5170 connection
Paramètres > Périphériques > Imprimantes et scanners > Ajouter > EPSON ET-5170 Series >
  Ajouter l'appareil  got it  Prêt  printed successfully
## Dropbox 218.3.4216.0
full re-indexation
## WSL Ubuntu 24.04.1 GnuPG keys
in  $Enc/Secure1/GnuPG/13F327EF,  gpg --import sprbMbArch-ob8-private.asc > passphrase
  gpg: key 842A4DEE13F327EF: public key "Joseph Harriott (sprbMb Arch) <jharr@ftml.net>" imported
  gpg: key 842A4DEE13F327EF: secret key imported
## Opera
Opera Stable 116.0.5366.71  installed, but no icon, so  winget rm Opera
winget add Opera.Opera
## DVDFab 13.0.3.5
allowed to update
## Opera
Paramètres > Basique > Au démarrage > Lancer  off
## Process Explorer
procexp64.exe  endlessly sync`d by Dropbox, so quit then  cpi $ITscc\forMSWin\ProcessExplorer\procexp64.exe "$Env:AppData\Microsoft\Windows\Start Menu\Programs\Startup"
## rg -uu  in  $DJH
maxing out RAM
## DVDFab 13.0.3.7
allowed to update
## Ghostscript v10.05 (in preparation for ImageMagick)
gs10050w64.exe  (C:\Program Files\gs\gs10.05.0, Generate cidfmap for Windows CJK TrueType fonts)
Applications et fonctionnalités > GPL Ghostscript > Désinstaller
precautionary reboot
gs10050w64.exe > C:\gs-10_05_0 (Generate cidfmap for Windows CJK TrueType fonts) rebooted
## ImageMagick Q8 7.1.1.46 x64
winget add ImageMagick.Q8
C:\Program Files\WindowsApps\ImageMagick.Q8_7.1.1.46_x64__b3hnabsze9y3j\magick.exe
fresh PowerShell for  magick -version
can't convert jpg's, so  winget rm ImageMagick.Q8
precautionary reboot
winget add ImageMagick.ImageMagick.Q8
magick wizard.jpg wizard.png
## CT2K8G4SFRA32A
f9 at boot for POST Error > Enter
40m UEFI Memory Quick Check PASSED
### BgInfo
& $HADLM\WinGet\Packages\Microsoft.Sysinternals.BGInfo_Microsoft.Winget.Source_8wekyb3d8bbwe\bginfo.exe > OK  got  Memory  correctly listed as  16260 MB
## Zig
where.exe zig  finds nothing, so  winget rm zig.zig
precautionary reboot for  winget add zig.zig  took ages to unpack
## MiniTool Partition Wizard Free v12.9
winget add MiniTool.PartitionWizard.Free
## Chafa
winget add chafa
## DVDFab 13.0.3.9
allowed to update
## zoxide
winget add zoxide
pulled over the data and removed ZLocation module directories
## lazygit
winget add lazygit
## Yazi
winget add yazi
## sd
winget add chmln.sd
## Ruby 3.2 remove
winget rm RubyInstallerTeam.Ruby.3.2
## Ruby 3.4
winget add RubyInstallerTeam.RubyWithDevKit.3.4  went to  C:/Ruby34-x64
### gems
new PS> gem li
gem install jekyll neovim
gem up --system
gem up
  ...
  Updating psych
  Fetching psych-5.2.3.gem
  Installing required msys2 packages: mingw-w64-ucrt-x86_64-libyaml
  avertissement : Le trousseau de clés publique est introuvable ; avez-vous exécuté « pacman-key --init » ?
start C:\Ruby34-x64\msys64 > ucrt64.exe
PSA> gem up
## WezTerm
winget add wez.wezterm
## winget update
PowerShell v7.5.1  not caught
Python & yt-dlp updates not really installed
## Firefox v138.0
after the  winget update  got a popup saying "Couldn't load XPCOM"
## Corepack
APS> corepack enable
## DVDFab 13.0.4.1
allowed to update > Ne plus afficher
## Rclone
winget add Rclone.Rclone
## $tIs dubious ownership
in there, APS> takeown /f . /r /d o
## DVDFab 13.0.4.3
allowed to update > Ne plus afficher
## Desktop Background
somehow got  Paramètres > Personnalisation > Arrière-plan > Diaporama
  resetting  to  Couleur unie  wouldn't stick, briefly selecting  Image  got it
## BgInfo gone
& $HADLM\WinGet\Packages\Microsoft.Sysinternals.BGInfo_Microsoft.Winget.Source_8wekyb3d8bbwe\bginfo.exe > OK  got  Memory  correctly listed as  16260 MB
## PS modules update
cmu got me  "BurntToast|PSFzf" | cmu -update -all -allowPrerelease -skipScan
## bat back into $PATH
C:\Users\jnbh\AppData\Local\Microsoft\WinGet\Packages\sharkdp.bat_Microsoft.Winget.Source_8wekyb3d8bbwe\bat-v0.25.0-x86_64-pc-windows-msvc\bat.exe -h
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU+';C:\Users\jnbh\AppData\Local\Microsoft\WinGet\Packages\sharkdp.bat_Microsoft.Winget.Source_8wekyb3d8bbwe\bat-v0.25.0-x86_64-pc-windows-msvc'; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
## DVDFab 13.0.4.6
allowed to update > Ne plus afficher
## WSL Ubuntu 24.04.1 LTS Ruby
sudo apt install gnuplot
  The following additional packages will be installed: aglfn gnuplot-data gnuplot-qt libgd3 libnotify4 libpcre2-32-0 libqt5core5t64 libqt5dbus5t64 libqt5gui5t64 libqt5network5t64 libqt5printsupport5t64 libqt5qml5 libqt5qmlmodels5 libqt5quick5 libqt5svg5 libqt5waylandclient5 libqt5waylandcompositor5 libqt5widgets5t64 libwxbase3.2-1t64 libwxgtk3.2-1t64 libxcb-xinerama0 libxcb-xinput0 qt5-gtk-platformtheme qttranslations5-l10n qtwayland5
  Suggested packages: gnuplot-doc libgd-tools notification-daemon qgnomeplatform-qt5 qt5-image-formats-plugins qt5-qmltooling-plugins
## mason.nvim
:MasonInstall ...  doesn`t close off at end...
## Zimbra Modern Desktop
Zimbra_Desktop_4.46.0_c975480bb_20250701133104.exe  C:\Program Files\Zimbra Desktop
  but can't find what to put for  serveur de messagerie
## DVDFab 13.0.4.7
allowed to update
## gokcehan's lf update failed
winget update gokcehan.lf
  remove: Accès refusé: "C:\Users\jnbh\AppData\Local\Microsoft\WinGet\Packages\gokcehan.lf_Microsoft.Winget.Source_8wekyb3d8bbwe\lf.exe"
  But it's there!
winget rm gokcehan.lf  still  ... Accès refusé...  so reboot got it working
## fix fd in $PATH
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU+';C:\Users\jnbh\AppData\Local\Microsoft\WinGet\Packages\sharkdp.fd_Microsoft.Winget.Source_8wekyb3d8bbwe\fd-v10.3.0-x86_64-pc-windows-msvc'; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
## 0patch
0PatchInstaller_22.11.11.10550.msi (${env:programfiles(x86)}\0patch) signed in
## MiKTeX updates
Start Menu > MiKTeX Console  for 129 updates
## explorer.exe  hogging CPU
Dropbox restarted, slow rescan of everything
APS> sfc /scannow
  La Protection des ressources Windows a détecté des fichiers corrompus et les a réparés. Pour les réparations en ligne, les détails sont inclus dans le fichier journal de CBS situé à l'emplacement suivant : windir\Logs\CBS\CBS.log. Exemple : C:\Windows\Logs\CBS\CBS.log. Pour les réparations hors connexion, les détails sont inclus dans le fichier journal fourni par l'indicateur /OFFLOGFILE.
APS> Dism /Online /Cleanup-Image /ScanHealth
  Aucun endommagement du magasin de composants n’a été détecté.
## ESU
https://www.microsoft.com/en-gb/windows/end-of-support > Get extended security updates >
  (Paramètres > S'inscrire aux mises à jour de sécurité étendues) > start "$MSWml/pag-ESU.png"
## fix lsd in $PATH
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU+';C:\Users\jnbh\AppData\Local\Microsoft\WinGet\Packages\lsd-rs.lsd_Microsoft.Winget.Source_8wekyb3d8bbwe'; $newPathCU  # g $HADLM\WinGet\Packages\lsd-rs.lsd_Microsoft.Winget.Source_8wekyb3d8bbwe
sp 'registry::hkcu\environment' -name path -value $newPathCU
lsd  still not found, so rebooted
## PowerShell v7.5.4
closed Nvim & PS for  PowerShell-7.5.4-win-x64.msi (C:\Program Files\PowerShell\) >
  [ Add 'Open here' context menu to Explorer
  Add 'Run with PowerShell 7' context menu for PowerShell files ] > Next > Next > UAC > Oui
## Python 3.14
winget rm Python.Python.3.13
Deleted  $HADL\Python\Python313  (next time  Delete  $HADL\Python ?)
### Python 3.13
winget add Python.Python.3.14
in a new PS, python -h  show it's in  $HADL\Programs\Python
### pipx
py -m pip install --user -U pipx
#### switch to $HADR\Python\Python314
Deleted  $HADR\Python\Python313
##### update $PATH
next time, before re-installing Python, change 14 to 15 in $PATH
###### remove $HADR\Python\python313\scripts from $PATH
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU -replace 'c:\\users\\jnbh\\appdata\\roaming\\python\\python313\\scripts;',''; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
###### add $HADR\Python\Python314\Scripts to $PATH
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU+';C:\Users\jnbh\AppData\Roaming\Python\Python314\Scripts'; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
#### pipx fail
pipx run pycowsay moo  failed looking for  $HADL\Python\Python313
#### Python 3.14 again
winget rm Python.Python.3.14
Deleted  $HADL\Python
winget add Python.Python.3.14
#### pipx again
Deleted  $HADR\Python
python -m pip install --user pipx
pipx run pycowsay moo  failed looking for  $HADL\Python\Python313
#### pipx again
Deleted  $HADR\Python, C:\Users\jnbh\pipx
python -m pip install --user pipx
pipx run pycowsay moo  rebuilt  C:\Users\jnbh\pipx, and worked
## waiting
luarocks-3.12.2-windows-64
### GitHub CLI
winget add GitHub.cli
# physical configuration
1366x768 screen
Intel Core i5-6300U
RAM CT2K8G4SFRA32A
## storage
(essential) M.2 SSD: 119Go LITEON CV1-8B128-HP
(optional) 2.5" SSD: BX500 shimmed to prevent disconnection
## Startup Menu
hold  esc  at start to get into  Startup Menu
hold  f9  at start to get into  Boot Menu
hold  f10  at start to get into  BIOS Setup
### BIOS Setup
Main > System Information > System BIOS : N75 Ver. 01.53 11/19/2021
#### Advanced
Built-in Device Options > Backlit keyboard timeout > 30 secs.
Secure Boot Configuration > Legacy Support Enable and Secure Boot Disable
