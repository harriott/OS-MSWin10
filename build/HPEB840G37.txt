vim: ft=build:

$MSWin10\build\HPEB840G37.txt

fn+echap (= HP System Information) long time to save to  $MSWml/o7o-HPSystemInformation.nfo
HP EliteBook 840 G3 barcoded PC117862 (labelled BC PNB 17 by last owner) = HPEB840G37
(jharrio@outlook.com)
# build - parallel
Google Chrome somehow there
Gestionnaire de périphériques > Cartes graphiques > Intel(R) HD Graphics 520
  double-clicked to discover  Pilote > 31.0.101.2111
Intel(R) HD Graphics 520 v31.0.101.2111 with 1Go memory
Notepad++ > alt+p > Préférences... > Divers > Surveillance de l'état des fichiers >
  Mise à jour sans alerte
  Aller à la dernière ligne après mise à jour
VLC Player > ctrl+p (= Preferences) > Pause on the last frame of a video > Always
## APS opacity
saps pwsh -verb runas  to right-click on toolbar for  Propriétés > Opacité > 80%
## AWPS opacity
saps powershell -verb runas  to right-click on toolbar for  Propriétés > Opacité > 80%
## AltSnap
winget add altsnap
  APS> schtasks /create /f /tn "AltSnap onlogon" /tr "$Env:AppData\AltSnap\AltSnap.exe" /sc onlogon /rl highest
  PS> $ASi="~\AppData\Roaming\AltSnap\AltSnap.ini"; (gc $ASi).replace('AutoSnap=2','AutoSnap=0') | seco -encoding utf8 $ASi
## BgInfo
ran it, font down to 8 and dark grey, positioned top right
## dark applications
Paramètres > Personnalisation > Couleurs > Choisir votre mode d'application par défaut > Sombre
## Desktop Background
Paramètres > [ Personnalisation > Arrière-plan > Couleur unie
Système > Écran > Mise à l'échelle et disposition > Modifier la taille du texte des applications et d'autres éléments > 100%
## Disk Usage
du64.exe  copied into $HADL\Microsoft\WindowsApps
## Edge
see  $ITsCP/WAN/browsers/browsers.txt
## Everything
Ctrl+P ( = Tools > Options ) > General >
  UI > [ Démarrer sur un clic simple > on  Résultats >
    Autoriser le clic double dans la colonne des chemin ]
  Polices and couleurs >
    Couleur d'avant plan > Personnalisé > selected a white
    Couleur d'arrière plan > Personnalisé > selected a olive
## FastStone Image Viewer
with an image open, e  for  C:\Program Files\IrfanView\i_view64.exe
## File Explorer
Affichage > Options > Affichage > [ [ Afficher l'icône des fichiers sure les miniatures  Afficher la barre d'état ] off-ticked  Afficher le chemin d'accès complet dans la barre de titre  on-ticked  Afficher les fichiers, dossier et lecteurs cachés  [ Masquer les extensions des fichiers dont le type est connu  Masquer les fichier protégés du système d'exploitation ]  off-ticked
## fix ; at end of path
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU -replace ';$', ''; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
## fonts - Architects Daughter
for  $Csst/data-1-sorted/counts.tex
sl $ITscc\forMSWin\fonts-FontSquirrel\architects-daughter
  right-clicked on  ArchitectsDaughter.ttf  to  Installer
## fonts - DejaVu fonts
$ITscc\forMSWin\fonts-dejavu-fonts-ttf-2.37\ttf > selected all, right clicked on to Install
  arrived in  $HADL\Microsoft\Windows\Fonts
## fonts - Noto Sans CJK Regulars for Pandoc
$coreIT\MSWin\fonts-copied\NotoHinted > selected all, right clicked on to Install
  arrived in  $HADL\Microsoft\Windows\Fonts
## Gestionnaire de tâches
Options > Masquer l'icône réduite
hidden icon dragged to taskbar
## IrfanView
winget add IrfanSkiljan.IrfanView -h  went to  "C:\Program Files\IrfanView\i_view64.exe"
ran it for  P (= Properties/Settings) > [ JPG > Auto-rotate off  Editing > Cut White ]
winget add IrfanSkiljan.IrfanView.PlugIns -h
## JRE
winget add Oracle.JavaRuntimeEnvironment  rebooted for it to work in  Vim
## language pack - UK
win+i (= Paramètres) > Heure et langue > Langue > Langues préférées > Ajouter une langue >
  English (United Kingdom) > Installer
## modules
$env:psmodulepath -split (';')
  C:\Users\jharr\Documents\PowerShell\Modules
  C:\Program Files\PowerShell\Modules
  c:\program files\powershell\7\Modules
  C:\Program Files\WindowsPowerShell\Modules
  C:\WINDOWS\system32\WindowsPowerShell\v1.0\Modules
## Notepad++
winget add --name notepad++
Alt+p (Paramètres) > Préférences > Mode Sombre > Mode sombre > Suivre Windows
## Paramètres
Comptes > Famille et autres utilisateurs > [ deauram@outlook.com  jnbh@live.co.uk ] >
  Autoriser
Personnalisation > Barre des tâches > Combiner les boutons de la barre des tâches > Jamais
Options d'ergonomie > Clavier > all off
Périphériques > Saisie > Orthographie >
  Corriger automatiquement les fautes d'orthograpie > Désactvé
### Système
Alimentation et mise en veille > Jamais, Jamais, 10 minutes, Jamais
  Paramètres d'alimentation supplémentaire >
    Choisir l'action des boutons d'alimentation >
    [ Modifier des paramètres actuellement non disponibles >
    Activer le démarrage rapide  off-ticked  Lorsque je referme le capot > Sur secteur >
    Ne rien faire ]
Multitâche > Alt + Tab > Uniquement les fenêtres ouvertes
Stockage (L'Assistant de stockage) > Activé (somehow)
#### Écran
Éclairage nocturne > Activé
Résolution de l'écran > 1920 x 1080 (recommandé)
## PDFtk
winget add PDFLabs.PDFtk.Free
## Process Explorer
start $ITscc\forMSWin\ProcessExplorer\procexp64.exe
  alt+o (= Options) > i (= Tray Icons) > p (= Physical Memory History)
  alt+o (= Options) > h (= Hide When Minimized)
  alt+o (= Options) > l (= Run At Logon)
## Ruby 3.2
winget add RubyInstallerTeam.Ruby.3.2
## Sécurité Windows
pinned to Start
## sharkdp/bat
winget add sharkdp.bat
## Signal
winget add OpenWhisperSystems.Signal
## QuickLook
winget add 9NV4BS3L1H4S --accept-package-agreements
## Zig
(for  tree-sitter) winget add zig.zig  took ages to unpack
zig version
## Thunderbird - fix version
Applications et fonctionnalités > Thunderbird > Désinstaller  got rid of older = C:\MT
### add to path
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU+';C:\Program Files\Mozilla Thunderbird'; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
## NanaZip
winget add M2Team.NanaZip
## Corepack
APS> corepack enable
## waiting
lazygit
# build - sequential
## move from Utilisateur
Paramètres >
Mise à jour et sécurité > Activation > Windows est activé à l'aide d'une license numérique
Système > À propos de >
  Spécifications de Windows > Windows 10 Pro 21H2 OS build 19044.1889
connected to  Jo-X10II
Mise à jour et sécurité > Windows Update > Updated to Windows 10 version 22H2
connected to  Jo-OPPO-A76
Menu > Système Windows >
[ Invite de Commandes  Outils d'administration  Panneau de configuration ] >
  Pinned to Start Menu > [ Disnéy  Microsoft 365 ] > right-click > Désintaller
win+i > Comptes > Famille et autres utilisateurs > Ajouter > jharrio@outlook.com > pw
win+i > Comptes > Famille et autres utilisateurs > Autres > Utilisateur > supprimer
## Ditto Clipboard
Microsoft Store > Ditto Clipboard > Install > Pin to Start
Ran it for  Options > General > [ Maximum Number of Saved Copies > 5000
 Advanced > Show leading whitespace ] ( C:\Users\jharr\AppData\Local\Ditto_WindowsApp\Ditto.db )
ctrl+* = Activate Ditto
## dropbox.com
Signed in > DropboxInstaller.exe > English & Selective sync
## symlinks
APS> . $MSWin10\mb\symlinks.ps1
## Analyse Microsoft Defender hors ligne
Sécurité Windows > Protection contre les virus et menaces > Options d'analyse > Analyse Microsoft Defender hors ligne > Analyser maintenant > Analyser > Contrôle de compte d'utilisateur > Oui
- wouldn't start the process, so  Paramètres > Mise à jour et sécurité > Récupération > Réinitialiser ce PC > Commencer > Conserver mes fichiers
- failed to find  KDTG311281  plugged in left or right loaded with  ESD-USB (français (France), Windows 10 2022 Update l Version 22H2)
so  Démarrage avancé > Redémarrer maintenant > Dépannage > Paramètres > Rédémarrer > BitLocker > entered the 8x6 number sequences for  DESKTOP-GSPV6OJ  but system powered off...
### BitLocker
Gestion des disques  reports  C: to be  NTFS (Chiffré avec BitLocker)
#### turn off
AIdc> manage-bde -status  then  manage-bde -off c:  and kept checking until done
### boot from KDTG311281
loaded with  ESD-USB (français (France), Windows 10 2022 Update l Version 22H2)
repeatedly hit  f9  at start to get into  Boot Menu >
UEFI - Kingston DataTraveler 3.0 08606E6D413DE361970C7E18 > Suivant > Réparer l'ordinateur
didn't get me anywhere so  booted into hard drive for  ESD-USB (D:) > setup.exe > Suivant >
Accepter  ensured 10G of free space on C: for  Installer
  eventually got me a  Partition de récupération
### Microsoft Defender Antivirus
APS> start-mpwdoscan
Paramètres > Sécurité Windows > Protection contre les virus et menaces (= Sécurité Windows) > Historique de protection
## unwanted HP Hotkey Support popup
empty popup appearing each time I try to change the screen brightness
Services > HP Hotkey UWP Service > Type de démarrage > (was Automatique) Désactivé
## gVim v9.1.0
gvim_9.1.0_x64_signed.exe
[ Create icons > On the Desktop off [ Create Default Config  Create Plugin Directories ] off ] >
(C:\Vim)  C:\Vim\vim91\vim.exe --version
## Windows Terminal
found in Microsoft Store > Obtenir  ($HADL\Microsoft\WindowsApps\wt.exe)
ctrl+, > Démarrage > Application Terminal par défaut > Terminal Windows
## PowerShell v7.4.0
found in Microsoft Store > Obtenir
## PowerShell execution policy
Get-ExecutionPolicy   reported  "Restricted"
### Administrateur PowerShell
Get-ExecutionPolicy -list  reported all as  "Undefined"
#### allow local unsigned and remote signed scripts
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser -Confirm > y
## $Profile
$Profile  returns
C:\Users\jharr\OneDrive\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1  so
OneDrive Paramètres > Gérer la sauvegarde > [ Documents  Images  Bureau ] off-slid
## Nom de l'appareil
Paramètres > Système > À propos de > (Nom de l'appareil > DESKTOP-GSPV6OJ)
Renommer ce PC > HPEB840G362
## code-minimap
code-minimap.exe  copied to  C:\Users\troin\AppData\Local\Microsoft\WindowsApps
## Python 3.12.3
python-3.12.3-amd64.exe > Add python.exe to PATH > Customize > Optional Features > for all users >
Next > [ Advanced Options > [ Install for all users  Customize install location > C:\Python312 ]
## WT 0 install
https://www.microsoft.com/en-gb/p/windows-terminal-preview/9n0dx20hk701
## WT 1 settings
chcp  reports  CodePage 850
ctrl+, (= Paramètres)
Actions > Basculer en mode plein écran > binned
Azure Cloud Shell > Masquez le profil de la liste déroulante > Activé
Démarrage > Profil par défaut > PowerShell
Interaction > M'avertir lorsque je ferme plusieurs onglets  off-slid
PowerShell > Apparance >
  Texte > Taille de police > 9
  Transparence > Opacité de l'arrière plan > 80%
  Type de police > Cascadia Mono
Ubuntu > Apparance >
  Jeu de couleurs > One Half Dark
  Texte > Taille de police > 9
  Transparence > Opacité de l'arrière plan > 90%
Windows PowerShell > Apparance > Texte > Taille de police > 9
$HADL\Packages\Microsoft.WindowsTerminal_8wekyb3d8bbwe\LocalState\settings.json
## Windows Terminal s'ouvre à l'Invite de commandes
Paramètres > Applications > Terminal > Désinstaller  then  win+x > Redémarrer
then re-installed from Microsoft Store
## Git v2.32
https://git-scm.com/download/win
Git-2.32.0-64-bit.exe > [ C:\Git  Select Components > [ Associate .sh with Bash > off
[ Check daily  Add Git Bash Profile to Windows Terminal ] > on ]
Checkout as is, commit Unix-style line endings
Choose a credential helper > None
$Env:Path -split';'
...
C:\Git\cmd
...
allowed  MINGW64  for  A ~/.bash_profile that loads ~/.bashrc will be created for you.
got me  C:\Git\usr\bin\perl.exe
## Windows Terminal s'ouvre à l'Invite de commandes
Paramètres > Applications > Terminal > Désinstaller  then  win+x > Redémarrer
then re-installed from Microsoft Store
## fzf (for PSFzf)
sl $ITscc  for  cpi fzf.exe $HADL\Microsoft\WindowsApps
fzf --version
## 7-Zip
7z2301-x64.exe
## SSH keys
mkdir ~/encrypted
mkdir ~/.ssh
cpi ~\Encrypted\Secure1\Networking\SSH\id_ed25519-forGitHub ~\.ssh\id_rsa
cpi ~\Encrypted\Secure1\Networking\SSH\id_ed25519-forGitHub.pub ~\.ssh\id_rsa.pub
## Test GitHub SSH connection
(requires Private key as  C:\Users\jharr\.ssh\id_rsa)
Git Bash > ssh -T git@github.com
The authenticity of host 'github.com (140.82.121.4)' can't be established.
ED25519 key fingerprint is SHA256:+DiY3wvvV6TuJJhbpZisF/zLDA0zPMSvHdkr4UvCOqU.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added 'github.com,140.82.118.4' (RSA) to the list of known hosts.
Hi harriott! You've successfully authenticated, but GitHub does not provide shell access.
got me  $HOME\.ssh\known_hosts
## KeePassXC
in Microsoft Store > Installer
C:\Users\jharr\Dropbox\JH\core\encrypted\JH.kdbx
ctrl+, (= Outils > Paramètres) > [
Général > Démarrage > Lancer automatiquement KeePassXC au démarrage du système  off
Intégration aux navigateurs > Activer > Edge ]
restarted Edge
## Sumatra PDF v3.4.6
SumatraPDF-3.5.2-64-install.exe >
Options > [ Installer pour tout les utilisateurs
Permettre à Windows de montrer des aperçus des documents PDF ] onticked > Ccu > Oui
"C:\Program Files\SumatraPDF\SumatraPDF.exe"
## HP Smart
in Microsoft Store > Installer
Se connecter  found  HPA22F0E (ENVY 5530)
Récupération des informations sur le pilote d'impression  took a while
## AutoHotkey v2.0.11
AutoHotkey_2.0.11_setup.exe
Shortcut to  $MSWin10\mb-HPEB840G362\user\jo.ahk  moved into
"$Env:AppData\Microsoft\Windows\Start Menu\Programs\Startup"
## after a reboot
Faisons une sauvegarde des données de votre PC > Ignorer pour le moment > Continuer
## FastStone Image Viewer v7.5
FSViewerSetup75.exe
ran it for Esc to offtick
*.png  Opens with FastStone Image Viewer
f12 (= Paramètres) > Aperçu >
[ En boucle  Rotation Auto par tag orientation EXIF > off  Unité par défaut > cm ]
### Settings
replaced  PaperSizeList  settings in  $HADR\FastStone\FSIV\FSSettings.db
with those in  $coreIT\MSWin\FSSettings-PaperSizeList.db
## Everything v1.4.1.1024
Everything-1.4.1.1024.x64-Setup.exe > clicked through > UAC
## The Platinum Searcher v2_2_0
cpi pt.exe $HADL\Microsoft\WindowsApps -force
pt /version
## ExifTool v12.76
cpi 'exiftool(-k).exe' $HADL\Microsoft\WindowsApps\exiftool.exe
## ZLocation v1.4.3
z  shows it's there, and  Get-InstalledModule  reports  1.4.3 ZLocation
c ~\Documents\PowerShell\Modules\ZLocation\1.4.3
## minimal Visual Studio - for Rust
VisualStudioSetup.exe > [ Composants individuels > [
Compilateurs, outils de génération et runtime >
  MSVC v143 - VS 2022 C++ x64/x86 build tools (dernière version)
SDK, biblothèaues et frameworks > Kit SDK Windows 10 (10.0.19041.0) ]
Modules linguistiques > Anglais ] (over 5GB) Installer
## Synaptics TouchPad became inactive
double tap wouldn't restore it, TouchStyk still working
began a Windows Update that seemed to get stuck,
so hard shutdown then reboot and the TouchPad was working again
## Windows Update
2024-01 Mise à jour de sécurité pour Windows 10 Version 22H2 pour les systèmes x64 (KB5034441)
Des problèmes sont survenus lors de l'installation des mises à jour, mais nous réessaierons ultérieurement. Si le problème persiste et que vous souhaitez rechercher des informations sur Internet ou contacter l'assistance pour en obtenir, ceci peut vous aider : (0x80070643)
## PC Health Check
WindowsPCHealthCheckSetup.msi
Processeur : Intel Core i5-6300U CPU @ 2.40GHz  ain't enough for Win11...
## Bulk Rename
BRU_setup_3.4.4.0.exe  Ran some changes to off-tick 2 notifications
## check fast startup off
Panneau de configuration > Tous les Panneaux de configuration > Options d'alimentation
Choisir l'action des boutons d'alimentation > Activer le démarrage rapide  is off
## KB5034441
Gestion de disques  shows
100Mo - Partition du système EFI
C: 118,42 Go NTFS - Démarrer, Fichier d'échange, image mémoire après incident, Partition de données de base
722Mo - Partition de récupératon
AIdc> reagentc /info
AIdc> reagentc /disable  for  diskpart
list disk
sel disk 0
list part
  N° partition   Type              Taille   Décalage
  -------------  ----------------  -------  --------
  Partition 1    Système            100 M   1024 K
  Partition 2    Réservé             16 M    101 M
  Partition 3    Principale         118 G    117 M
  Partition 4    Récupération       722 M    118 G
sel part 3
shrink desired=250 minimum=200
  Erreur du service de disque virtuel : La taille de réduction spécifiée est trop grande et le volume sera plus petit que la taille de volume minimale.
exit
reagentc /enable
## Windows Backup
Comptes > Sauvegarde Windows > Vérifier > trohib@gmail.com > Security code
### remove symlink in ~\Documents
ri ~\Documents\PowerShell\Microsoft.PowerShell_profile.ps1
cpi $MSWin10\PSProfileStub.ps1 ~\Documents\PowerShell\Microsoft.PowerShell_profile.ps1
ri ~\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1
cpi $MSWin10\PSProfileStub.ps1 ~\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1
## Windows ADK & Windows PE
adksetup.exe  (C:\Program Files (x86)\Windows Kits\10\)
off-ticked all but  Outils de déploiement  around 130 Mo
adkwinpesetup.exe  3,6 Go !
## create bootable Windows PE media - fail
Démarrage > Windows Kits > Environnement de déploiement et d'outils de création d'images
épinglé au menu Démarrer  then ran as Administrator
  cd "..\Windows Preinstallation Environment\amd64"
  md C:\WinPE_amd64\mount
  Dism /Mount-Image /ImageFile:"en-us\winpe.wim" /index:1 /MountDir:"C:\WinPE_amd64\mount"
  Xcopy "C:\WinPE_amd64\mount\Windows\Boot\EFI\bootmgr.efi" "Media\bootmgr.efi" /Y
  Xcopy "C:\WinPE_amd64\mount\Windows\Boot\EFI\bootmgfw.efi" "Media\EFI\Boot\bootx64.efi" /Y
  Dism /Unmount-Image /MountDir:"C:\WinPE_amd64\mount" /commit
    Erreur : 0xc1420117
      Le répertoire n'a pas pu être complètement démonté. Ce problème est généralement dû aux applications qui ont des fichiers encore ouverts dans le répertoire de montage. Fermez ces fichiers et réeffectuez le démontage afin de terminer le processus de démontage.
      Le fichier journal DISM se trouve à l'emplacement C:\WINDOWS\Logs\DISM\dism.log
  Dism /Unmount-Image /MountDir:"C:\WinPE_amd64\mount" /commit
    Erreur : 0xc142011d
      L'image montée spécifiée ne peut pas être revalidée dans le fichier WIM. Ce problème se produit lorsqu'une image a subi un démontage partiel ou lorsqu'une image est encore montée. Si cette image a été démontée avec une validation antérieure, la validation a probablement réussi. Veuillez vérifier si c'est le cas, puis effectuez un démontage sans validation.
      Le fichier journal DISM se trouve à l'emplacement C:\WINDOWS\Logs\DISM\dism.log
exit
## optimize-volume
PS> Optimize-Volume -DriveLetter C -Analyze -Verbose
...
Il n'est pas nécessaire de défragmenter ce volume.
## MiniTool Partition Wizard Free v12.8
pw-free-online.exe > édition gratuite > ShadowMaker off_ticked
Ran it for "Ne pas afficher ce message à nouveau."
## Ghostscript v10.02.1 (in preparation for ImageMagick)
gs10021w64.exe > C:\gs-10_02_1  rebooted
## remove Windows PE
Paramètres > Applications > Extensions de l'environnement de préinstallation Windows (Win PE) du Kit de déploiment et d'évaluation Windows 3,64 Go > Désinstaller
## ExifTool v12.77
cpi "$ITscc\forMSWin\exiftool(-k).exe" $HADL\Microsoft\WindowsApps\exiftool.exe
## Go
go1.22.0.windows-amd64.msi > C:\Go\
## WizTree v4.18
wiztree_4_18_setup.exe > pas d'icônes
## Rust for ripgrep
(once Visual Studio components) winget add rustup
## ripgrep
(once Rust) winget add burntsushi.ripgrep.msvc
## Git v2.44.0
## Thunderbird v115.8
winget add mozilla.thunderbird
winget rm mozilla.thunderbird
## unwanted HP Hotkey Support popup
empty popup appearing each time I try to change the screen brightness
Services > HP Hotkey UWP Service > Type de démarrage > (was Automatique) Désactivé
rebooted
## no BurntToast notifications from PowerShell
~\Documents\PowerShell\Modules\BurntToast\0.8.5\README.md
rebooted  for  uninstall-module burnttoast
APS> install-module burnttoast  got it in the same location and still no notifications...
Paramètres > Applications > PowerShell > Uninstall
Idc> winget add microsoft.powershell
WT: [erreur 2147942402 (0x80070002) lors du lancement de `"C:\Users\jharr\AppData\Local\Microsoft\WindowsApps\Microsoft.PowerShell_8wekyb3d8bbwe\pwsh.exe"'] so
PowerShell > Ligne de commande > "C:\Program Files\PowerShell\7\pwsh.exe"
New-BurntToastNotification
## Sumatra PDF v3.5.2
winget add SumatraPDF -h -l C:\SumatraPDF
## update-help
Update-Help: Failed to update Help for the module(s) 'AppBackgroundTask, Appx, AssignedAccess, BitLocker, BitsTransfer, BranchCache, CimCmdlets, Defender, DirectAccessClientComponents, Dism, DnsClient, EventTracingManagement, International, Kds, LanguagePackManagement, LAPS, Microsoft.PowerShell.Archive, Microsoft.PowerShell.Core, Microsoft.PowerShell.Diagnostics, Microsoft.PowerShell.Host, Microsoft.PowerShell.LocalAccounts, Microsoft.PowerShell.Management, Microsoft.PowerShell.Operation.Validation, Microsoft.PowerShell.PSResourceGet, Microsoft.PowerShell.Security, Microsoft.PowerShell.Utility, Microsoft.WSMan.Management, MMAgent, NetAdapter, NetConnection, NetEventPacketCapture, NetLbfo, NetNat, NetQos, NetSecurity, NetSwitchTeam, NetTCPIP, NetworkConnectivityStatus, NetworkSwitchManager, NetworkTransition, PackageManagement, PcsvDevice, PKI, PnpDevice, PowerShellGet, PrintManagement, ProcessMitigations, Provisioning, PSDiagnostics, PSReadLine, ScheduledTasks, SecureBoot, SmbShare, SmbWitness, StartLayout, Storage, ThreadJob, TLS, TroubleshootingPack, TrustedPlatformModule, UEV, VpnClient, Wdac, Whea, WindowsDeveloperLicense, WindowsErrorReporting, WindowsSearch, WindowsUpdate' with UI culture(s) {fr-FR} : No UI culture was found that matches the following pattern: fr-FR. Verify the pattern and then try the command again..
Update-Help: Failed to update Help for the module(s) 'ConfigDefenderPerformance, PSReadline' with UI culture(s) {fr-FR} : One or more errors occurred. (Response status code does not indicate success: 404 (The specified blob does not exist.).).
English-US help content is available and can be installed using: Update-Help -UICulture en-US.
update-help -uiculture en-gb
update-help -uiculture en-us
## switched to $MSWin10\AZERTY.ahk
## ImageMagick
winget add imagemagick  went to  "C:\Program Files\ImageMagick-7.1.1-Q16-HDRI"
fresh PowerShell for:  magick wizard: wizard.jpg
then  magick wizard.jpg win:  first time generated an IMDisplay
  "C:\Users\troin\AppData\Local\Temp\magick-<weirdCode> was not found"
  2nd run, got the jpg opened in IMDisplay   ri wizard.jpg
## Google Chrome icon not showing in Start Menu
C:\Program Files\Google\Chrome\Application\chrome.exe
winget rm google.chrome
C:\Program Files (x86)\Google  Deleted
winget add google.chrome  got  $HADL\Google\Chrome\Application\chrome.exe
## MiKTeX
winget add miktex  went to  $HADL\Programs\MiKTeX
rebooted for  MiKTeX Console  which got me a necessary update
MiKTeX Console  for 10 updates
$HADL\MiKTeX  created at some point
sl $jtIT\CP\TeX\distro-MiKTeX\miktex-xetex  for  x mwe.tex  and off_ticked "Always show this dialog"
## Pandoc
after MiKTeX
winget add JohnMacFarlane.Pandoc  got  $HADL\Pandoc\pandoc.exe
  sl $ITsCP\Pandoc  for
    pandoc --toc --toc-depth=6 -f markdown_strict toCdepth6MWE.md -o toCdepth6MWE.pdf
    - took a while for MiKTeX to download all the necessary packages
  md $tex\latex\m4p
## path too long for gVim swap
gp -path "registry::\hklm\system\currentcontrolset\control\filesystem" | fl -property longpathsenabled
sp 'hklm:\system\currentcontrolset\control\filesystem' -name 'longpathsenabled' -value 1
rebooted
didn't fix it, and anyway doesn't help gVim
## yt-dlp (and FFmpeg)
winget add yt-dlp.yt-dlp
Ce package nécessite les dépendances suivantes :
  - Packages
      Gyan.FFmpeg
(1/1) Trouvé FFmpeg [Gyan.FFmpeg] Version 6.1.1
...
Téléchargement en cours https://github.com/GyanD/codexffmpeg/releases/download/6.1.1/ffmpeg-6.1.1-full_build.zip
...
Installé correctement
Téléchargement en cours https://github.com/yt-dlp/yt-dlp/releases/download/2023.12.30/yt-dlp.exe
### FFmpeg
$HADL\Microsoft\WinGet\Packages\Gyan.FFmpeg_Microsoft.Winget.Source_8wekyb3d8bbwe\ffmpeg-6.1.1-full_build\bin\ffmpeg.exe
ffmpeg -version
### yt-dlp
C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\yt-dlp.yt-dlp_Microsoft.Winget.Source_8wekyb3d8bbwe\yt-dlp.exe
yt-dlp --version
## Windows Package Manager Updates
winget update --all
## LibreOffice 24.2.0.3
I seem to've installed with winget.
ran it to build  ~\AppData\Roaming\LibreOffice\4
in  user\  removed  config  folder &  registrymodifications.xcu
  & replaced them from  $ITsCP\documenting\LibreOffice\lcu-sbMb-user
## WSL
### fails (maybe needed to reboot)
winget add 9MZNMNKSM73X > agreed to  https://vineelsai.com/Privacy/Apps/ArchWSL.html
Installing, this may take a few minutes...
WslRegisterDistribution failed with error: 0x8007019e
Error: 0x8007019e Le sous-systÞme Windows pour Linux n'a pas ÚtÚ activÚ.
winget rm 9MZNMNKSM73X
wsl --install  then  Windows Menu > Ubuntu  got me
WslRegisterDistribution failed with error: 0x80080005
Error: 0x80080005 échec de l'exécution du serveur
Paramètres > Applications > linux > Désinstaller
### Microsoft Store
https://apps.microsoft.com/detail/9p9tqf7mrm4r > Télécharger > Obténir
WslRegisterDistribution failed with error: 0x80080005
Error: 0x80080005 échec de l'exécution du serveur
reboot  got a Ubuntu lancement WT
UNIX username > jo > pw
### configure Ubuntu
touch ~/.hushlogin
apt update
Reading package lists... Done
E: Could not open lock file /var/lib/apt/lists/lock - open (13: Permission denied)
E: Unable to lock directory /var/lib/apt/lists/
W: Problem unlinking the file /var/cache/apt/pkgcache.bin - RemoveCaches (13: Permission denied)
W: Problem unlinking the file /var/cache/apt/srcpkgcache.bin - RemoveCaches (13: Permission denied)
sudo apt update  reported 84 so  ...
sudo apt upgrade
## sharkdp.fd
winget add sharkdp.fd
### path modified
Variable d'environnement de chemin modifiée ; redémarrez votre interpréteur de commandes pour utiliser la nouvelle valeur.
Alias de ligne de commande ajouté : "bat"
and, yes, it added  "C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\sharkdp.bat_Microsoft.Winget.Source_8wekyb3d8bbwe\bat-v0.24.0-x86_64-pc-windows-msvc;;"
#### fix ;;
$oldPathCU = (gp -path 'registry::hkcu\environment' -name path).path
$oldPathCU
C:\Users\jharr\.cargo\bin;C:\Users\jharr\AppData\Local\Microsoft\WindowsApps;C:\Users\jharr\go\bin;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\BurntSushi.ripgrep.MSVC_Microsoft.Winget.Source_8wekyb3d8bbwe\ripgrep-14.1.0-x86_64-pc-windows-msvc;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\sharkdp.bat_Microsoft.Winget.Source_8wekyb3d8bbwe\bat-v0.24.0-x86_64-pc-windows-msvc;
##### remove trailing ;
$newPathCU = $oldPathCU -replace ';$', ''
$newPathCU
sp -path 'registry::hkcu\environment' -name path -value $newPathCU
## gokcehan's lf
winget add gokcehan.lf
### path modified
Variable d’environnement de chemin modifiée ; redémarrez votre interpréteur de commandes pour utiliser la nouvelle valeur.
Alias de ligne de commande ajouté : "lf"
#### fix ;;
$oldPathCU = (gp -path 'registry::hkcu\environment' -name path).path; $oldPathCU
C:\Users\jharr\.cargo\bin;C:\Users\jharr\AppData\Local\Microsoft\WindowsApps;C:\Users\jharr\go\bin;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\BurntSushi.ripgrep.MSVC_Microsoft.Winget.Source_8wekyb3d8bbwe\ripgrep-14.1.0-x86_64-pc-windows-msvc;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\sharkdp.bat_Microsoft.Winget.Source_8wekyb3d8bbwe\bat-v0.24.0-x86_64-pc-windows-msvc;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\sharkdp.fd_Microsoft.Winget.Source_8wekyb3d8bbwe\fd-v9.0.0-x86_64-pc-windows-msvc;C:\Users\jharr\AppData\Local\Programs\MiKTeX\miktex\bin\x64\;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\Gyan.FFmpeg_Microsoft.Winget.Source_8wekyb3d8bbwe\ffmpeg-6.1.1-full_build\bin;C:\Users\jharr\go\bin;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\gokcehan.lf_Microsoft.Winget.Source_8wekyb3d8bbwe;
##### remove trailing ;
$newPathCU = $oldPathCU -replace ';$', ''; $newPathCU
sp -path 'registry::hkcu\environment' -name path -value $newPathCU
## less-Windows
winget install jftuga.less
### path modified
Variable d’environnement de chemin modifiée ; redémarrez votre interpréteur de commandes pour utiliser la nouvelle valeur.
Alias de ligne de commande ajouté : "less"
Alias de ligne de commande ajouté : "lesskey"
#### fix ;;
$oldPathCU = (gp -path 'registry::hkcu\environment' -name path).path; $oldPathCU
C:\Users\jharr\.cargo\bin;C:\Users\jharr\AppData\Local\Microsoft\WindowsApps;C:\Users\jharr\go\bin;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\BurntSushi.ripgrep.MSVC_Microsoft.Winget.Source_8wekyb3d8bbwe\ripgrep-14.1.0-x86_64-pc-windows-msvc;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\sharkdp.bat_Microsoft.Winget.Source_8wekyb3d8bbwe\bat-v0.24.0-x86_64-pc-windows-msvc;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\sharkdp.fd_Microsoft.Winget.Source_8wekyb3d8bbwe\fd-v9.0.0-x86_64-pc-windows-msvc;C:\Users\jharr\AppData\Local\Programs\MiKTeX\miktex\bin\x64\;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\Gyan.FFmpeg_Microsoft.Winget.Source_8wekyb3d8bbwe\ffmpeg-6.1.1-full_build\bin;C:\Users\jharr\go\bin;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\gokcehan.lf_Microsoft.Winget.Source_8wekyb3d8bbwe;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\jftuga.less_Microsoft.Winget.Source_8wekyb3d8bbwe;
##### remove trailing ;
$newPathCU = $oldPathCU -replace ';$', ''; $newPathCU
sp -path 'registry::hkcu\environment' -name path -value $newPathCU
## EUDC 1252 (for PowerColorLS icons)
right-clicked on  $ITscc/font-Nerd-CascadiaMono/CaskaydiaMonoNerdFontMono-Regular.ttf >
Installer  then (should be only)  Installer pour tous les utilisateurs
test-path hkcu:\eudc\1252
ni -path hkcu:\eudc\1252
sp hkcu:\eudc\1252 -name SystemDefaultEUDCFont -value CaskaydiaMonoNerdFontMono-Regular.ttf -type string
(gp hkcu:\eudc\1252).SystemDefaultEUDCFont
## gokcehan lf configuration
md $HADL\lf
## reboot to ensure path changes for PowerShell
## Chafa
winget add chafa
### path modified
Variable d’environnement de chemin modifiée ; redémarrez votre interpréteur de commandes pour utiliser la nouvelle valeur.
Alias de ligne de commande ajouté : "chafa"
#### fix ;;
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
C:\Users\jharr\.cargo\bin;C:\Users\jharr\AppData\Local\Microsoft\WindowsApps;C:\Users\jharr\go\bin;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\BurntSushi.ripgrep.MSVC_Microsoft.Winget.Source_8wekyb3d8bbwe\ripgrep-14.1.0-x86_64-pc-windows-msvc;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\sharkdp.bat_Microsoft.Winget.Source_8wekyb3d8bbwe\bat-v0.24.0-x86_64-pc-windows-msvc;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\sharkdp.fd_Microsoft.Winget.Source_8wekyb3d8bbwe\fd-v9.0.0-x86_64-pc-windows-msvc;C:\Users\jharr\AppData\Local\Programs\MiKTeX\miktex\bin\x64\;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\Gyan.FFmpeg_Microsoft.Winget.Source_8wekyb3d8bbwe\ffmpeg-6.1.1-full_build\bin;C:\Users\jharr\go\bin;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\gokcehan.lf_Microsoft.Winget.Source_8wekyb3d8bbwe;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\jftuga.less_Microsoft.Winget.Source_8wekyb3d8bbwe;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\hpjansson.Chafa_Microsoft.Winget.Source_8wekyb3d8bbwe\chafa-1.14.0-1-x86_64-win;
##### remove trailing ;
$newPathCU = $oldPathCU -replace ';$', ''; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
## LSD
winget add lsd
### path modified
Variable d’environnement de chemin modifiée ; redémarrez votre interpréteur de commandes pour utiliser la nouvelle valeur.
Alias de ligne de commande ajouté : "lsd"
#### fix ; at end of path
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
C:\Users\jharr\.cargo\bin;C:\Users\jharr\AppData\Local\Microsoft\WindowsApps;C:\Users\jharr\go\bin;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\BurntSushi.ripgrep.MSVC_Microsoft.Winget.Source_8wekyb3d8bbwe\ripgrep-14.1.0-x86_64-pc-windows-msvc;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\sharkdp.bat_Microsoft.Winget.Source_8wekyb3d8bbwe\bat-v0.24.0-x86_64-pc-windows-msvc;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\sharkdp.fd_Microsoft.Winget.Source_8wekyb3d8bbwe\fd-v9.0.0-x86_64-pc-windows-msvc;C:\Users\jharr\AppData\Local\Programs\MiKTeX\miktex\bin\x64\;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\Gyan.FFmpeg_Microsoft.Winget.Source_8wekyb3d8bbwe\ffmpeg-6.1.1-full_build\bin;C:\Users\jharr\go\bin;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\gokcehan.lf_Microsoft.Winget.Source_8wekyb3d8bbwe;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\jftuga.less_Microsoft.Winget.Source_8wekyb3d8bbwe;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\hpjansson.Chafa_Microsoft.Winget.Source_8wekyb3d8bbwe\chafa-1.14.0-1-x86_64-win;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\lsd-rs.lsd_Microsoft.Winget.Source_8wekyb3d8bbwe\lsd-v1.0.0-x86_64-pc-windows-msvc;
##### remove trailing ;
$newPathCU = $oldPathCU -replace ';$', ''; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
## Nom de l'appareil
Paramètres > Système > À propos de > Nom de l'appareil (DESKTOP-GSPV6OJ) >
Renommer ce PC > HPEB840G37
## eza
winget add eza-community.eza
### path modified
Variable d’environnement de chemin modifiée ; redémarrez votre interpréteur de commandes pour utiliser la nouvelle valeur.
Alias de ligne de commande ajouté : "eza"
fixed ; at end of path
## path to LSD dissappeared
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = "$oldPathCU;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\lsd-rs.lsd_Microsoft.Winget.Source_8wekyb3d8bbwe\lsd-v1.1.2-x86_64-pc-windows-msvc"; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
## Gpg4win
winget add gnupg.gpg4win  arrived in  C:\Program Files (x86)\Gpg4win
## add 7-Zip to path
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = "$oldPathCU;C:\Program Files\7-Zip"; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
## Emacs - no good for Vim
winget add emacs
APS> ri $env:programfiles\Emacs -force -recurse
all other attmempts to  add  to  C:\Emacs  failed  $env:programfiles\Emacs  to run  Uninstall.exe
## Emacs v29.3 - good for Vim
winget add emacs  then  APS> mv $env:programfiles\Emacs C:\Emacs -force
## fzf.exe v0.48.0 (for PSFzf)
$MSWin10\build\fzf.ps1
## gokcehan's lf update failed
### uninstall fail
winget rm gokcehan.lf
remove: Accès refusé: "C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\gokcehan.lf_Microsoft.Winget.Source_8wekyb3d8bbwe\lf.exe"
### uninstall
reboot  for  winget rm gokcehan.lf  (should've tried update)  still in  $env:path
winget add gokcehan.lf
Alias de ligne de commande ajouté : "lf"
## Neovim
winget add Neovim.Neovim  rebooted   nvim  for Lazy installs
## pipx
py -m pip install --user pipx
Installing collected packages: platformdirs, packaging, colorama, argcomplete, click, userpath, pipx
  WARNING: The script userpath.exe is installed in 'C:\Users\jharr\AppData\Roaming\Python\Python312\Scripts' which is not on PATH.
  Consider adding this directory to PATH or, if you prefer to suppress this warning, use --no-warn-script-location.
  WARNING: The script pipx.exe is installed in 'C:\Users\jharr\AppData\Roaming\Python\Python312\Scripts' which is not on PATH.
  Consider adding this directory to PATH or, if you prefer to suppress this warning, use --no-warn-script-location.
Successfully installed argcomplete-3.2.3 click-8.1.7 colorama-0.4.6 packaging-24.0 pipx-1.5.0 platformdirs-4.2.0 userpath-1.9.2
sl ~\AppData\Roaming\Python\Python312\Scripts
for  .\pipx.exe ensurepath
Success! Added C:\Users\jharr\.local\bin to the PATH environment variable.
Success! Added C:\Users\jharr\AppData\Roaming\Python\Python312\Scripts to the PATH environment variable.
Consider adding shell completions for pipx. Run 'pipx completions' for instructions.
## pynvim (for neovim)
(needed for python packages)  pip install pynvim
## Python executable
where.exe python
C:\Python312\python.exe
C:\Users\jharr\AppData\Local\Microsoft\WindowsApps\python.exe
- the latter fires up Microsoft Store. I could remove them from APS
## Jekyll
(in a refreshed Powershell) gem install bundler jekyll
## Ruby neovim gem
gem install neovim
MSYS2 could not be found. Please run 'ridk install'
ridk install  failed, but fired up  MSYS2  installer  C:\msys64
ridk install  did a huge pacman install and got me  C:\msys64\usr\bin\perl.exe
gem install neovim
## Node.js
winget add OpenJS.NodeJS
Node.js  icon pulled over to Start Menu, run for  console.log('Hello')
C:\Program Files\nodejs\node.exe
$programfiles\nodejs\node_modules\corepack\README.md
$programfiles\nodejs\node_modules\npm\README.md
npm prefix -g  reports  C:\Users\jharr\AppData\Roaming\npm
md C:\Users\jharr\AppData\Roaming\npm   then  npm ls -g  works
npm i -g carbonyl  then  carbonyl https://github.com
/bin/bash: C:UsersjharrAppDataRoamingnpm/node_modules/carbonyl/index.sh: No such file or directory
## Node.js - npm - neovim
npm install -g neovim
## Perl
winget add StrawberryPerl.StrawberryPerl
## Perl - Neovim::Ext
cpanm Neovim::Ext  authorised  Perl interpreter  in  Windows Firewall
Building and testing IO-Async-0.803 ... FAIL
! Installing IO::Async failed. See C:\Users\jharr\.cpanm\work\1712687394.5784\build.log for details. Retry with --force to force install it.
! Installing the dependencies failed: Module 'IO::Async' is not installed
! Bailing out the installation for Neovim-Ext-0.06.
10 distributions installed
cpanm Neovim::Ext  failed again on  IO-Async-0.803
cpanm IO::Async  failed again
### Perl remove
winget rm StrawberryPerl.StrawberryPerl  - took a long time and closed  gVim
rm -r ~\.cpanm -force  C:\Strawberry  is empty
### Perl again
winget add StrawberryPerl.StrawberryPerl
## Perl - Neovim::Ext again
cpanm Neovim::Ext  failed again on  IO-Async-0.803
### Perl remove again
winget rm StrawberryPerl.StrawberryPerl  - took a long time and closed  gVim
rm -r ~\.cpanm -force  C:\Strawberry  is empty
### Perl again
winget add StrawberryPerl.StrawberryPerl
### Perl - Neovim::Ext again
cpanm IO::Async  then  cpanm Neovim::Ext
fucking-well tried to re-install  IO::Async, and so failed again...
### Perl remove again
winget rm StrawberryPerl.StrawberryPerl  - took a long time and closed  gVim
rm -r ~\.cpanm -force  C:\Strawberry  is empty
### Perl again
winget add StrawberryPerl.StrawberryPerl
### Perl - Neovim::Ext again
ppm install Neovim::Ext
Error installing package 'Neovim-Ext': Could not locate a PPD file for package Neovim-Ext
### Perl - Neovim::Ext abandoned
probably never going to work on native MSWin
## CMake
winget add Kitware.CMake
## Visual Studio Setup PowerShell Module
inmo VSSetup
## Visual Studio Build Tools 2022 to make  telescope-fzf-native.nvim
vs_BuildTools.exe (Visual Studio Installer) > [ Composants individuels > [
  Compilateurs, outils de génération et runtime >
    MSVC v143 - VS 2022 C++ x64/x86 build tools (dernière version)
    Outils C++ CMake pour Windows
  SDK, biblothèaues et frameworks >
    Kit de développement logiciel (SDK) Windows 10 (10.0.20348.0)
] > (under 2GB) Installer, 131 packages
## ShellCheck
winget add koalaman.shellcheck
### path modified
Variable d’environnement de chemin modifiée ; redémarrez votre interpréteur de commandes pour utiliser la nouvelle valeur.
Alias de ligne de commande ajouté : "shellcheck"
fixed ; at end of path
## developer mode (for nvim-treesitter)
Paramétres > Mise à jour et sécurité > Espace développeurs > Mode développeur > Activé
## nvim  in  x64 Native Tools Command Prompt for VS 2022
Erreur détectée en traitant C:\Users\jharr\AppData\Local\nvim\init.vim :
ligne   92 :
E5108: Error executing lua vim/_init_packages.lua:21: C:\Users\jharr\AppData\Local\nvim/lua/lazy/treesitter.lua:15: '=' expected near 'lua'
stack traceback:
      [C]: in function 'error'
      vim/_init_packages.lua:21: in function <vim/_init_packages.lua:15>
      [C]: in function 'require'
      C:\Users\jharr\AppData\Local\nvim/lua/init.lua:50: in main chunk
      [C]: in function 'require'
      [string ":lua"]:1: in main chunk
## Git v2.45.0
## fd v10.0.0
executable lost from path
### add  fd.exe  to path
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
#### 1 accidentally included the executable
$newPathCU = "$oldPathCU;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\sharkdp.fd_Microsoft.Winget.Source_8wekyb3d8bbwe\fd-v10.0.0-x86_64-pc-windows-msvc\fd.exe"
sp 'registry::hkcu\environment' -name path -value $newPathCU
#### 2 remove the executable name
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU -replace '\\fd.exe$', ''; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
## fzf from winget
$MSWin10\build\fzf.ps1
& $HADL\Microsoft\WinGet\Links\fzf.exe --version
fixed ; at end of path
## fd v10.1.0
executable lost from path
### add  fd.exe  to path
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
#### 1 accidentally included the executable
$newPathCU = "$oldPathCU;C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\sharkdp.fd_Microsoft.Winget.Source_8wekyb3d8bbwe\fd-v10.1.0-x86_64-pc-windows-msvc\fd.exe"
sp 'registry::hkcu\environment' -name path -value $newPathCU
#### 2 remove the executable name
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU -replace '\\fd.exe$', ''; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
## bash.exe versions
C:\Git\bin\bash.exe --help
C:\Windows\System32\bash.exe --help
C:\Users\jharr\AppData\Local\Microsoft\WindowsApps\bash.exe --help
## FastStone Image Viewer v7.8
f12 (= Paramètres) > Aperçu > [
Confirmer la reéctirure des fichiers  Lancer les images associées > dans une Fenêtre ]
## XnView MP
winget add XnSoft.XnViewMP
ran it for  Assistant de démarrage > Thème > Sombre
## Prettier
from somewhere, npm i -D -E prettier  not working so  npm un prettier
(~\AppData\Roaming\npm\node_modules\prettier  still there)
npm i -g -D -E prettier
## Thunderbird
winget add mozilla.thunderbird -h -l C:\MT
ran it to get  $HADR\Thunderbird\Profiles\q6qwq868.default-release
which I emptied, and then edited  $HADR\Thunderbird\profiles.ini
  [Profile0] section:
    Name=default-release
    IsRelative=0
    Path=C:\Users\jharr\Dropbox\JH\Thb-dr
ran it for (default-release) Démarrer Thunderbird)
## Neovide
winget add neovide  'C:\Program Files\Neovide\neovide.exe'
## SQLite
winget add sqlite.sqlite
Alias de ligne de commande ajouté : "sqldiff"
Alias de ligne de commande ajouté : "sqlite3_analyzer"
Alias de ligne de commande ajouté : "sqlite3"
didn't seem to install a  sqlite3.dll
## reduce C:
MiniTool Partition Wizard Free v12.8
right-clicked on C: > Déplacer/redimensionner > Taille de la partition > 118.15
## Edge reconfigure
annoying process
F12 (= DevTools) to clear away question
## FFmpeg v7.0.1 path
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU -replace '7.0', '7.0.1'; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
## switched to  $MSWin10\AutoHotkey\1920x1080.ahk
having previously switched to  $MSWin10\AutoHotkey\HPEB840G37.ahk
## new Outlook for Windows
after reboot, accepted > Importer les paramètres
## Epson EcoTank ET-5170
plugged into USB (got it going)
Paramètres > Périphériques > Imprimantes et scanners > Ajouter > DIRECT-8b-EPSON-ET-5170 Series >
Ajouter l'appareil (Connexion) > Pilote indisponible  so  epson637525eu.exe (= Pilote v3.01.00) >
Installation des utilitaires > Connexion réseau  failed, so  Connexion USB  then unplugged for
Paramètres > Périphériques > Imprimantes et scanners > Ajouter > DIRECT-8b-EPSON-ET-5170 Series >
Ajouter l'appareil (Connexion) > still Pilote indisponible  so  winget add 9WZDNCRFJ4P8
## switched back to  $MSWin10\AutoHotkey\HPEB840G37.ahk
because different users
## Epson EcoTank ET-5170
Applications et fonctionnalités > Epson Software Updater > Désinstaller
Ajouter l'appareil (Connexion) > still Pilote indisponible  so
Applications et fonctionnalités > Désinstallation de l'imprimante EPSON ET-5170 Series >
Désinstaller > Microsoft IPP Class Driver > OK > Oui > OK
Ajouter l'appareil (Connexion) > still Pilote indisponible
Applications et fonctionnalités > Epson Print and Scan > Désinstaller
Ajouter l'appareil (Connexion) > still Pilote indisponible
epson637525eu.exe failed to find on LAN or USB, so Manuel / USB002 (EPSONET-5170 Series FAX)
Epson Printer Connection Checker  can't connect by LAN, Wi-Fi, or USB...
EPSON Status Monitor 3: EPSON ET-5170 Series  can't connnect by LAN or Wi-Fi
Epson Print and Scan Installer.exe  doesn't find the printer...
somehow got to  Install Navi [ET-5170 Series]  which took ages to install some stuff > Wi-Fi
downloaded EpsonNet Setup  which eventually failed to connect
## Lua from MS fail
winget add 9WZDNCRDLTZP > y
got unusable  $CPF\WindowsApps\2490UnSoft.Lua_1.0.0.0_x64__eqt05ahzs4mk6\Lua.exe
winget rm 9WZDNCRDLTZP
winget add 9WZDNCRDLTZP -l C:\Lua > y
still got unusable  $CPF\WindowsApps\2490UnSoft.Lua_1.0.0.0_x64__eqt05ahzs4mk6\Lua.exe
winget rm 9WZDNCRDLTZP
## Lua
cp D:\Dropbox\JH\core\IT_stack\copied-code\forMSWin\LuaBinaries\lua-5.4.2_Win64_bin C:\Lua -recurse
### add to path
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = "$oldPathCU;C:\Lua"; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
lua54 -v
### LuaRocks
cp D:\Dropbox\JH\core\IT_stack\copied-code\forMSWin\luarocks-3.11.1-windows-64\* C:\Lua
## $HADR\Thunderbird cleanup
polluted with what's normally in  $HADR\Thunderbird\Profiles\xxxxxxxx.default-esr
Deleted all but  installs.ini, Profiles, profiles.ini
emptied  Profiles
in $HADR\Thunderbird\profiles.ini
removed [ProfileN] for N > 0
[Profile0]
  Name=default-esr
  IsRelative=0
  Path=D:\Dropbox\JH\Thb-dr
[Install5CC7CE6A1DCFB43B]
  Default=D:\Dropbox\JH\Thb-dr
  Locked=1
## updating WSL
PS> wsl -l -o  shows  Ubuntu-24.04
$ lsb_release -a  reports  Ubuntu 22.04.4 LTS
sudo apt update && sudo apt upgrade
The following packages have been kept back:
  libldap-2.5-0 libldap-common python3-update-manager update-manager-core
sudo apt-get install libldap-2.5-0 libldap-common python3-update-manager update-manager-core
sudo do-release-upgrade  returns  There is no development version of an LTS available.
sudo apt install plocate  then took ages to initialize the database
symlink to  $MSn/WSL/bash_profile  fixed
### packages
sudo apt install fd-find fzf highlight nnn ranger ripgrep
#### zoxide
sudo apt install zoxide
sudo apt remove zoxide
#### 7zip
sudo apt install 7zip
sudo apt remove 7zip
sudo apt install p7zip-full
#### notify-send
sudo apt install libnotify-bin
but  notify-send -u critical "test of critical notification"
  gets "Could not connect: No such file or directory"
#### Samokovarov's jump
sudo snap install jump
#### tmux
sudo apt install tmux
. $MSn/set/6-WSL-nodes.sh
#### wslu
sudo add-apt-repository ppa:wslutilities/wslu
got me  \\wsl$\Ubuntu\etc\apt\sources.list.d\wslutilities-ubuntu-wslu-jammy.list
sudo apt update
sudo apt install wslu
## Epson EcoTank ET-5170
still Pilote indisponible  so
Applications et fonctionnalités > Désinstallation de l'imprimante EPSON ET-5170 Series > ...
Applications et fonctionnalités > Epson Print and Scan > Désinstaller > ...
Applications et fonctionnalités > EpsonNet Print > Désinstaller > ...
Applications et fonctionnalités > Epson Scan 2 > Désinstaller > ...
Applications et fonctionnalités > Epson Printer Connection Checker > ...
epson637525eu.exe (driver v3.01.00) got it working when plugged into USB
epson661623eu.exe (Epson Software updater v4.6.7.0) and ran it with printer plugged into USB for
  Pilote d'impression v3.02.00
  Epson Printer Connection Checker v3.4.0.0
  Epson ScanSmart v3.7.10
- took forever to download even when switched to a fast connection...
ran again to get  Epson ScanSmart v3.7.10
Epson Printer Connection Checker v3.4.0.0  couldn`t find it on LAN, and so I allowed
Install Navi [ET-5170 Series], which again took ages and brought in an unwanted Fax Utility
  it found the printer on 192.168.1.3
unplugged the LAN, and the printer's gone, so, from the Setup Navi page, got
  Epson_ET-5170_Series_LM_11_Web.exe, which again downloaded a driver without telling me which
  then  EpsonNet Setup  was again slowly downoaded...
  managed to get the printer connected to  SSID cafezoide pro
Applications et fonctionnalités > Désinstallation de l'imprimante EPSON ET-5170 Series >
ET-5170 Series(Réseau) and  ET-5170 Series  uninstalled
## gem update
...
Updating sass-embedded
Fetching sass-embedded-1.77.8-x64-mingw-ucrt.gem
sass-embedded's executable "sass" conflicts with sass
Overwrite the executable? [yN] y
...
Gems updated: addressable bundler commonmarker dnsruby faraday faraday-net_http google-protobuf html-pipeline selma zeitwerk irb jekyll jekyll-coffeescript jekyll-commonmark-ghpages jekyll-relative-links liquid minitest neovim net-ftp net-imap nokogiri octokit public_suffix racc rbs reline rexml rouge sass-embedded stringio
## Epson EcoTank ET-5170
Applications et fonctionnalités > [
Epson Event Manager > Désinstaller
Epson PC-FAX Driver > Désinstaller
epson637525eu.exe (driver v3.01.00) got it working when plugged into USB
## Rclone
winget add Rclone.Rclone
## $TeNo/md-JH-DailyLife/roles/roles.md
:se fenc  reports  latin1
## winget update --all  stuck on  yt-dlp
keeps re-offering it, and not pursuing the other updates
same after a reboot so  winget rm yt-dlp.yt-dlp
## WT Ubuntu
Ubuntu
Icône > https://assets.ubuntu.com/v1/49a1a858-favicon-32x32.png - the one that shows in use
Ligne de commande > ubuntu.exe
Masquez le profil de la liste déroulante > Désactivé
Ubuntu
Icône > ms-appx:///ProfileIcons/{9acb9455-ca41-5af7-950f-6bca1bc9722f}.png
Ligne de commande > C:\Windows\system32\wsl.exe -d Ubuntu
Masquez le profil de la liste déroulante > Activé
## ExifTool v12.96
cpi "$ITscc\forMSWin\exiftool-12_96_64\exiftool(-k).exe" $HADL\Microsoft\WindowsApps\exiftool.exe
cpi -recurse $ITscc\forMSWin\exiftool-12_96_64\exiftool_files $HADL\Microsoft\WindowsApps
exiftool -ver
## fix LSD in $PATH
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU+';C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\lsd-rs.lsd_Microsoft.Winget.Source_8wekyb3d8bbwe\lsd-v1.1.5-x86_64-pc-windows-msvc'; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
## fix fd in $PATH
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU+';C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\sharkdp.fd_Microsoft.Winget.Source_8wekyb3d8bbwe\fd-v10.2.0-x86_64-pc-windows-msvc'; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
## sfc
AIdc> sfc /scannow  seemed to find some errors so  rebooted  AIdc> sfc /scannow
## HP Smart
searched for and found  HP ENVY Inspire 7200  then took a while to setup
Imprimantes et scanners > Ajouter une imprimante ou un scanner >
HPC204A4 (HP ENVY Inspire 7200 series)
## HX256GSSDSATA3 inaccessible
took it out and chkdsk'd from HPEB840G38 - no errors, refitted and all good
## fix rg in $PATH
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU+';C:\Users\jharr\AppData\Local\Microsoft\WinGet\Packages\BurntSushi.ripgrep.MSVC_Microsoft.Winget.Source_8wekyb3d8bbwe\ripgrep-14.1.1-x86_64-pc-windows-msvc'; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
## WSL Ubuntu trash-cli
sudo apt install trash-cli
The following packages were automatically installed and are no longer required:
htop libnl-3-200 libnl-genl-3-200
Use 'sudo apt autoremove' to remove them.
## MediaInfo
winget add MediaArea.MediaInfo
## MiKTeX updates
! LaTeX Error: File `currfile.sty' not found.  while compiling
Start Menu > MiKTeX Console  for 117 updates
## GIMP
winget add GIMP.GIMP
## Opera
winget add XP8CF6S8G2D5T6
## Microsoft.PowerShell.PSResourceGet
somehow got the preview2 version
## Opera
Paramètres > Au démarrage > Lancer au démarrage de mon ordinateur  décoché
## Thunderbird
ran it to get  $HADR\Thunderbird\Profiles\khnbhnp8.default-esr-1
launched it only enough to get  $HADR\Thunderbird\Profiles\xxxxxxxx.default-esr-1  which I Deleted
again, then
$HADR\Thunderbird\installs.ini  Deleted
$HADR\Thunderbird\profiles.ini  reduced to just
[Profile0]
  Name=default-esr
  IsRelative=0
  Path=D:\Dropbox\JH\Thb-dr
[General]
  StartWithLastProfile=0
  Version=2
launched for  Thunderbird - Choissisez un profil utilisateur > Démarrer Thunderbird
brought  [InstallD78BF5DD33499EC2]  into  $HADR\Thunderbird\profiles.ini
  and a new  $HADR\Thunderbird\installs.ini
## WSL Ubuntu luarocks neomutt neovim
sudo apt install luarocks neomutt neovim
## WSL lsd
sudo snap install lsd
## WSL Ubuntu remove neovim
sudo apt remove luarocks neovim
## Python 3.13
winget rm Python.Python.3.12
didn't remove  $HADR\Python\Python312, C:\Python312\include, C:\Python312\Lib
probably unneccessary reboot
winget add Python.Python.3.13
where.exe python  reports  C:\Users\jharr\AppData\Local\Programs\Python\Python313\python.exe
Deleted  C:\Python312
### pipx
py -m pip install --user -U pipx
Installing collected packages: platformdirs, packaging, colorama, argcomplete, click, userpath, pipx
  WARNING: The scripts activate-global-python-argcomplete.exe, python-argcomplete-check-easy-install-script.exe and register-python-argcomplete.exe are installed in 'C:\Users\jharr\AppData\Roaming\Python\Python313\Scripts' which is not on PATH.
  Consider adding this directory to PATH or, if you prefer to suppress this warning, use --no-warn-script-location.
  WARNING: The script userpath.exe is installed in 'C:\Users\jharr\AppData\Roaming\Python\Python313\Scripts' which is not on PATH.
  Consider adding this directory to PATH or, if you prefer to suppress this warning, use --no-warn-script-location.
  WARNING: The script pipx.exe is installed in 'C:\Users\jharr\AppData\Roaming\Python\Python313\Scripts' which is not on PATH.
  Consider adding this directory to PATH or, if you prefer to suppress this warning, use --no-warn-script-location.
Successfully installed argcomplete-3.5.1 click-8.1.7 colorama-0.4.6 packaging-24.1 pipx-1.7.1 platformdirs-4.3.6 userpath-1.9.2
$HADR\Python\Python313> fd --max-depth 2
Scripts\
  Scripts\activate-global-python-argcomplete.exe
  Scripts\pipx.exe
  Scripts\python-argcomplete-check-easy-install-script.exe
  Scripts\register-python-argcomplete.exe
  Scripts\userpath.exe
site-packages\
  site-ackages\argcomplete\
  site-packages\argcomplete-3.5.1.dist-info\
  site-packages\click\
  site-packages\click-8.1.7.dist-info\
  site-packages\colorama\
  site-packages\colorama-0.4.6.dist-info\
  site-packages\packaging\
  site-packages\packaging-24.1.dist-info\
  site-packages\pipx\
  site-packages\pipx-1.7.1.dist-info\
  site-packages\platformdirs\
  site-packages\platformdirs-4.3.6.dist-info\
  site-packages\userpath\
  site-packages\userpath-1.9.2.dist-info\
Deleted  $HADR\Python\Python312
### remove $HADR\Python\python312\scripts from $PATH
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU -replace 'c:\\users\\jharr\\appdata\\roaming\\python\\python312\\scripts;',''; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
### add $HADR\Python\Python313 to $PATH
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU+';C:\Users\jharr\AppData\Roaming\Python\Python313\Scripts'; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
### test pipx
pipx run pycowsay moo
## remove multiple $HOME\go\bin from $PATH
$oldPathCU = (gp 'registry::hkcu\environment' path).path; $oldPathCU
$newPathCU = $oldPathCU -replace 'C:\\Users\\jharr\\go\\bin;',''; $newPathCU
sp 'registry::hkcu\environment' -name path -value $newPathCU
## IrfanView v4.70
winget update IrfanSkiljan.IrfanView  refused, so  winget rm IrfanSkiljan.IrfanView
winget add IrfanSkiljan.IrfanView  refused, so
Paramètres > Applications > IrfanView > Désinstaller > Désinstaller
winget add IrfanSkiljan.IrfanView
fixed ; at end of path
winget add IrfanSkiljan.IrfanView.PlugIns
### FastStone Image Viewer
opened an image > f12 > Programmes > Supprimer  then  e > Ajout > C:\Program Files\IrfanView\i_view64.exe
## WSL Ubuntu mbsync notmuch pass
sudo apt install isync notmuch pass
## WSL Ubuntu - GnuPG keys
gpg -k
gpg: directory '/home/jo/.gnupg' created
gpg: keybox '/home/jo/.gnupg/pubring.kbx' created
gpg: /home/jo/.gnupg/trustdb.gpg: trustdb created
in  $Enc/Secure1/GnuPG/13F327EF,  gpg --import sprbMbArch-m2o-private.asc > passphrase
## WSL Ubuntu - pass
rsync -irtv --delete $Enc/Secure1/password-store/ ~/.password-store
## WSL Ubuntu - GnuPG keys
in  $Enc/Secure1/GnuPG/13F327EF,  gpg --import sprbMbArch-ob8-private.asc > passphrase
## Windows Update
HP Development Company, L.P. - Extension - 8.10.29.1
## WSL Ubuntu Pro
sudo apt update
sudo pro attach <FPT>
sudo apt update
sudo apt upgrade
## IrfanView
ran it for  P (= Properties/Settings) > [ JPG > Auto-rotate off  Editing > Cut White ]
## Desktop Background
somehow got  Paramètres > Personnalisation > Arrière-plan > Diaporama
  (and system was slow and keyboard was messed up) resetting  to  Couleur unie  wouldn't stick
  fixed after a reboot
## BgInfo
& $HADLM\WinGet\Packages\Microsoft.Sysinternals.BGInfo_Microsoft.Winget.Source_8wekyb3d8bbwe\bginfo.exe
## MiniTool Partition Wizard Free v12.9
allowed
## csvkit
pipx install csvkit
  installed package csvkit 2.0.1, installed using Python 3.13.1
  These apps are now globally available
    csvclean.exe
    csvcut.exe
    csvformat.exe
    csvgrep.exe
    csvjoin.exe
    csvjson.exe
    csvlook.exe
    csvpy.exe
    csvsort.exe
    csvsql.exe
    csvstack.exe
    csvstat.exe
    in2csv.exe
    sql2csv.exe
## ShellCheck RAM
shellcheck.exe  using lots of RAM
## Dropbox reset
v214.4.517 (same as on HPEB840G38) after a reboot somehow
  2) wanted me again to choose my folders again, though it remembered all my old choices
  3) required me to rename away  D:\Dropbox  to  D:\D, but after I'd killed it, I saw it'd dissappeared from Start Menu so  Paramètres > Applications > Dropbox > Désinstaller  took ages...
## dropbox.com
https://www.dropbox.com/install for  DropboxInstaller.exe > set my  Selective sync  choices, then got it to move the folder, then closed it to move back in my files, reran it
## Epson EcoTank ET-5170 connection
HPEB840G37  at  192.168.0.41
ET-5170  at  192.168.0.65, but not found...
Paramètres > Périphériques > Imprimantes et scanners > Ajouter > EPSONFE86A3 (ET-5170 Series) >
  Ajouter l'appareil  got it  Prêt
## XpdfReader v4.05
XpdfReader-win64-4.05.exe  (C:\Program Files\Glyph & Cog\XpdfReader-win64)
## WSL Ubuntu - ncdu
sudo apt install ncdu
## Ce PC disk space usage bar
disappeared, so  Affichage > Options > Affichage > Réinitialer les dossiers
## WSL Ubuntu - .bash_history
cp \\wsl$\Ubuntu\home\jo\.bash_history $MSWml/WSL/bash_history-$((get-date).tostring("yyMMdd-HHmmss")).sh
## WSL Ubuntu 24.04.1 LTS
winget add Canonical.Ubuntu.2404
Windows Menu > Ubuntu 24.04.1 LTS  fired up a new WT & installed it > UNIX username > jo > pw
all WT quit for  WT > ctrl+5 (= Ubuntu 24.04 LTS tab)
## WSL Ubuntu 24.04 update
touch ~/.hushlogin
sudo apt update  reported 182 so  sudo apt upgrade
lsb_release -a  reports  Ubuntu 24.04.1 LTS
## WT Ubuntu 24.04 settings
WT > ctrl+, > Ubuntu 24.04 Apparance >
  Jeu de couleurs > One Half Dark
  Texte > Taille de police > 9
  Transparence > Opacité de l'arrière plan > 81%
## WT Ubuntu 24.04 received settings
Ubuntu 24.04 LTS
  Icône > https://assets.ubuntu.com/v1/49a1a858-favicon-32x32.png - the one that shows in use
  Ligne de commande > ubuntu2404.exe
  Masquez le profil de la liste déroulante > Désactivé
Ubuntu 24.04
  Icône > ms-appx:///ProfileIcons/{9acb9455-ca41-5af7-950f-6bca1bc9722f}.png
  Ligne de commande > C:\Windows\system32\wsl.exe -d Ubuntu-24.04
  Masquez le profil de la liste déroulante > Activé
## WSL Ubuntu 24.04 Bash configuration
$MSn/set/5-WSL-Bash.sh
## WSL Ubuntu 24.04 packages
sudo apt install bc dos2unix fd-find fzf highlight isync ncdu neofetch neomutt neovim nnn notmuch pass p7zip-full ranger ripgrep tmux trash-cli
## WSL Ubuntu 24.04 Samokovarov's jump
sudo snap install jump
## WSL Ubuntu 24.04 plocate
sudo apt install plocate  then took ages to initialize the database
cp /etc/updatedb.conf $MSWml/WSL/updatedb-$(date '+%y%m%d-%H%M').conf
sudo cp $MSn/WSL/updatedb.conf /etc/updatedb.conf  then  sudo updatedb  (much faster)
## WSL Ubuntu 24.04 nodes
. $MSn/set/6-WSL-nodes.sh
## WSL Ubuntu 24.04 wslu
sudo add-apt-repository ppa:wslutilities/wslu
  got me  \\wsl$\Ubuntu-24.04\etc\apt\sources.list.d\wslutilities-ubuntu-wslu-noble.sources
sudo apt update
sudo apt install wslu
## WSL Ubuntu 24.04 lsd
sudo snap install lsd
## WSL Ubuntu 24.04 remove neovim
sudo apt remove neovim
## WSL Ubuntu 24.04 GnuPG keys
gpg -k
  gpg: directory '/home/jo/.gnupg' created
  gpg: keybox '/home/jo/.gnupg/pubring.kbx' created
  gpg: /home/jo/.gnupg/trustdb.gpg: trustdb created
in  $Enc/Secure1/GnuPG/13F327EF,  gpg --import sprbMbArch-ob8-private.asc > passphrase
  gpg: key 842A4DEE13F327EF: public key "Joseph Harriott (sprbMb Arch) <jharr@ftml.net>" imported
  gpg: key 842A4DEE13F327EF: secret key imported
## WSL Ubuntu 24.04 password-store
rsync -irtv --delete $Enc/Secure1/password-store/ ~/.password-store
## WSL Ubuntu 24.04 Pro
sudo pro attach <FPT>
[sudo] password for jo:
  Enabling Ubuntu Pro: ESM Apps
  ...
  Enabling Ubuntu Pro: ESM Infra
  ...
  This machine is now attached to 'Ubuntu Pro - free personal subscription'
  SERVICE          ENTITLED  STATUS       DESCRIPTION
  anbox-cloud      yes       disabled     Scalable Android in the cloud
  esm-apps         yes       enabled      Expanded Security Maintenance for Applications
  esm-infra        yes       enabled      Expanded Security Maintenance for Infrastructure
  landscape        yes       disabled     Management and administration tool for Ubuntu
  NOTICES: Operation in progress: pro attach
  For a list of all Ubuntu Pro services, run 'pro status --all'
  Enable services with: pro enable <service>
  Account: trohib@gmail.com
  Subscription: Ubuntu Pro - free personal subscription
sudo apt update
sudo apt upgrade
  The following upgrades have been deferred due to phasing:
    python3-distupgrade ubuntu-release-upgrader-core
## WSL Ubuntu remove
closed WT for  Applications et fonctionnalités > Ubuntu > Désinstaller
## WSL Ubuntu 24.04 libdata-printer-perl
(for  Data::Printer  in  $clMail/notmuch/nmsh-sort.pl) sudo apt install libdata-printer-perl
## BgInfo
& $HADLM\WinGet\Packages\Microsoft.Sysinternals.BGInfo_Microsoft.Winget.Source_8wekyb3d8bbwe\bginfo.exe > OK
## moved to $coreIT
### allow Dropboox to work
ri "$HADR\Microsoft\Windows\Start Menu\Programs\Startup\HPEB840G37.ahk.lnk"
quit  Process Explorer
### resume full functionality
APS> $MSn\set  to run the scripts
shortcut to  $MSn\AutoHotkey\HPEB840G37.ahk
  to  "$HADR\Microsoft\Windows\Start Menu\Programs\Startup"
### Process Explorer
start $ITscc\forMSWin\ProcessExplorer\procexp64.exe
## WT Ubuntu Apparance
WT > ctrl+, > Ubuntu Apparance >
  Jeu de couleurs > One Half Dark
  Texte > Taille de police > 9
  Transparence > Opacité de l'arrière plan > 79%
## WSL Ubuntu reconfigure
ran the scripts in  $MSn\set
## Dropbox 217.3.4243.0
triggered a re-indexation
## OpenSSL versions
C:\Git\mingw64\bin\openssl.exe version
  reported  OpenSSL 3.2.3 3 Sep 2024 (Library: OpenSSL 3.2.3 3 Sep 2024)
C:\Git\usr\bin\openssl.exe version
  reported  OpenSSL 3.2.3 3 Sep 2024 (Library: OpenSSL 3.2.3 3 Sep 2024)
C:\msys64\ucrt64\bin\openssl.exe version  reported  OpenSSL 1.1.1q  5 Jul 2022
C:\msys64\usr\bin\openssl.exe version  reported  OpenSSL 1.1.1q  5 Jul 2022
where.exe openssl  reports  C:\Strawberry\c\bin\openssl.exe
  openssl version  reported  OpenSSL 3.3.0 9 Apr 2024 (Library: OpenSSL 3.3.0 9 Apr 2024)
wsl openssl version  slow to report  OpenSSL 3.0.2 15 Mar 2022 (Library: OpenSSL 3.0.2 15 Mar 2022)
## SQLite remove
winget update --all
  ...
  ... Trouvé SQLite [SQLite.SQLite] Version 3.48.0
  ...
  Le code de hachage du programme d’installation ne correspond pas.
winget rm sqlite.sqlite
## Ookla Speedtest
winget add Ookla.Speedtest.Desktop
## Process Explorer
Run At Logon  never working, so  cpi $ITscc\forMSWin\ProcessExplorer\procexp64.exe "$Env:AppData\Microsoft\Windows\Start Menu\Programs\Startup"
## Hamachi
winget add Hamachi
after a reboot, Préférences > Paramètres > bienvenue décoché
## Rustup v1.28.0
took a long time
## AltSnap
wasn't working - clicking on tray icon to disable then re-enable got it going
## Ghostscript v10.05
Applications et fonctionnalités > GPL Ghostscript > Désinstaller
gs10050w64.exe > C:\gs-10_05_0 (Generate cidfmap for Windows CJK TrueType fonts) rebooted
## Samsung 8GB RAM from HPEB840G38
30m UEFI Memory Quick Check PASSED
### BgInfo
& $HADLM\WinGet\Packages\Microsoft.Sysinternals.BGInfo_Microsoft.Winget.Source_8wekyb3d8bbwe\bginfo.exe > OK  got  Memory  correctly listed as  16260 MB
## Gems
gem update
  ...
  Updating typeprof
  ERROR:  Error installing typeprof:
    typeprof-0.30.1 requires Ruby version >= 3.3. The current ruby version is 3.2.1.
  ...
gem list
  WARN: Unresolved or ambiguous specs during Gem::Specification.reset:
    stringio (>= 0)
    Available/installed versions of this gem:
    - 3.1.5
    - 3.1.1
    - 3.0.4
  WARN: Clearing out unresolved specs. Try 'gem cleanup <gem>'
  Please report a bug if this causes problems.
  ...
gem cl stringio  didn't help...
gem uni stringio
  Gem stringio-3.0.4 cannot be uninstalled because it is a default gem
  Successfully uninstalled stringio-3.1.5
gem up  brought back that warning
## Ruby 3.2 remove
winget rm RubyInstallerTeam.Ruby.3.2
Applications et fonctionnalités > MSYS2 > Désinstaller > Désinstaller > Désinstaller
C:/Ruby32-x64  Deleted
## Ruby 3.4
winget add RubyInstallerTeam.RubyWithDevKit.3.4  went to  C:/Ruby34-x64
gem install neovim
(in a refreshed Powershell) gem install bundler jekyll
### update gems
#### update gems - fail
gem up
  ...
  Updating psych
  Fetching psych-5.2.3.gem
  Installing required msys2 packages: mingw-w64-ucrt-x86_64-libyaml
  avertissement : Le trousseau de clés publique est introuvable ; avez-vous exécuté « pacman-key --init » ?
  erreur : clangarm64 : la clé « 5F944B027F7FE2091985AA2EFA11531AA0AA7F57 » est inconnue
  erreur : le trousseau de clés n’est pas accessible en écriture
  erreur : mingw32 : la clé « 5F944B027F7FE2091985AA2EFA11531AA0AA7F57 » est inconnue
  erreur : le trousseau de clés n’est pas accessible en écriture
  erreur : mingw64 : la clé « 5F944B027F7FE2091985AA2EFA11531AA0AA7F57 » est inconnue
  erreur : le trousseau de clés n’est pas accessible en écriture
  erreur : ucrt64 : la clé « 5F944B027F7FE2091985AA2EFA11531AA0AA7F57 » est inconnue
  erreur : le trousseau de clés n’est pas accessible en écriture
  erreur : clang64 : la clé « 5F944B027F7FE2091985AA2EFA11531AA0AA7F57 » est inconnue
  erreur : le trousseau de clés n’est pas accessible en écriture
  erreur : msys : la clé « 5F944B027F7FE2091985AA2EFA11531AA0AA7F57 » est inconnue
  erreur : le trousseau de clés n’est pas accessible en écriture
  erreur : la base de données « clangarm64 » n’est pas valide (base de données non valide ou corrompue (signature PGP))
  erreur : la base de données « mingw32 » n’est pas valide (base de données non valide ou corrompue (signature PGP))
  erreur : la base de données « mingw64 » n’est pas valide (base de données non valide ou corrompue (signature PGP))
  erreur : la base de données « ucrt64 » n’est pas valide (base de données non valide ou corrompue (signature PGP))
  erreur : la base de données « clang64 » n’est pas valide (base de données non valide ou corrompue (signature PGP))
  erreur : la base de données « msys » n’est pas valide (base de données non valide ou corrompue (signature PGP))
  pacman failed with the following output:
  Building native extensions. This could take a while...
  ERROR:  Error installing psych:
        ERROR: Failed to build gem native extension.
  ...
  Gem files will remain installed in C:/Ruby34-x64/lib/ruby/gems/3.4.0/gems/psych-5.2.3 for inspection.
  Results logged to C:/Ruby34-x64/lib/ruby/gems/3.4.0/extensions/x64-mingw-ucrt/3.4.0/psych-5.2.3/gem_make.out
PSA> gem up  same psych error
#### initialise MSYS2
start C:\Ruby34-x64\msys64 > ucrt64.exe
  MSYS2 is starting for the first time. Executing the initial setup.
  Copying skeleton files.
  These files are for the users to personalise their msys2 experience.
  They will never be overwritten nor automatically updated.
  'C:\WINDOWS\system32\drivers\etc\hosts' -> '/etc/hosts'
  'C:\WINDOWS\system32\drivers\etc\protocol' -> '/etc/protocols'
  'C:\WINDOWS\system32\drivers\etc\services' -> '/etc/services'
  'C:\WINDOWS\system32\drivers\etc\networks' -> '/etc/networks'
  gpg: /etc/pacman.d/gnupg/trustdb.gpg: trustdb created
  gpg: no ultimately trusted keys found
  gpg: starting migration from earlier GnuPG versions
  gpg: porting secret keys from '/etc/pacman.d/gnupg/secring.gpg' to gpg-agent
  gpg: migration succeeded
  ==> Generating pacman master key. This may take some time.
  gpg: Generating pacman keyring master key...
  gpg: directory '/etc/pacman.d/gnupg/openpgp-revocs.d' created
  gpg: revocation certificate stored as '/etc/pacman.d/gnupg/openpgp-revocs.d/09EF6F352DBFCC7596393460464D4F38D7828719.rev'
  gpg: Done
  ==> Updating trust database...
  gpg: marginals needed: 3  completes needed: 1  trust model: pgp
  gpg: depth: 0  valid:   1  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 1u
  ==> Appending keys from msys2.gpg...
  ==> Locally signing trusted keys in keyring...
    -> Locally signed 5 keys.
  ==> Importing owner trust values...
  gpg: setting ownertrust to 4
  gpg: setting ownertrust to 4
  gpg: setting ownertrust to 4
  gpg: setting ownertrust to 4
  gpg: setting ownertrust to 4
  ==> Disabling revoked keys in keyring...
    -> Disabled 4 keys.
  ==> Updating trust database...
  gpg: marginals needed: 3  completes needed: 1  trust model: pgp
  gpg: depth: 0  valid:   1  signed:   5  trust: 0-, 0q, 0n, 0m, 0f, 1u
  gpg: depth: 1  valid:   5  signed:   7  trust: 0-, 0q, 0n, 5m, 0f, 0u
  gpg: depth: 2  valid:   4  signed:   2  trust: 4-, 0q, 0n, 0m, 0f, 0u
  gpg: next trustdb check due at 2025-08-13
  gpg: error retrieving 'alexey.pawlow@gmail.com' via WKD: No data
  gpg: error reading key: No data
  gpg: refreshing 1 key from hkps://keyserver.ubuntu.com
  gpg: key F40D263ECA25678A: "Alexey Pavlov (Alexpux) <alexey.pawlow@gmail.com>" not changed
  gpg: Total number processed: 1
  gpg:              unchanged: 1
  gpg: error retrieving 'david.macek.0@gmail.com' via WKD: No data
  gpg: error reading key: No data
  gpg: refreshing 1 key from hkps://keyserver.ubuntu.com
  gpg: key 790AE56A1D3CFDDC: "David Macek (MSYS2 master key) <david.macek.0@gmail.com>" not changed
  gpg: Total number processed: 1
  gpg:              unchanged: 1
  gpg: error retrieving 'martellmalone@gmail.com' via WKD: No data
  gpg: error reading key: No data
  gpg: refreshing 1 key from hkps://keyserver.ubuntu.com
  gpg: key DA7EF2ABAEEA755C: "Martell Malone (martell) <martellmalone@gmail.com>" not changed
  gpg: Total number processed: 1
  gpg:              unchanged: 1
  gpg: error retrieving 'reiter.christoph@gmail.com' via WKD: No data
  gpg: error reading key: No data
  gpg: refreshing 1 key from hkps://keyserver.ubuntu.com
  gpg: key 755B8182ACD22879: "Christoph Reiter (MSYS2 master key) <reiter.christoph@gmail.com>" not changed
  gpg: Total number processed: 1
  gpg:              unchanged: 1
  gpg: error retrieving 'icquinteiro@gmail.com' via WKD: No data
  gpg: error reading key: No data
  gpg: refreshing 1 key from hkps://keyserver.ubuntu.com
  gpg: key 9F418C233E652008: "Ignacio Casal Quinteiro <icquinteiro@gmail.com>" not changed
  gpg: Total number processed: 1
  gpg:              unchanged: 1
  gpg: error retrieving 'mingw.android@gmail.com' via WKD: No data
  gpg: error reading key: No data
  gpg: refreshing 1 key from hkps://keyserver.ubuntu.com
  gpg: key BBE514E53E0D0813: "Ray Donnelly (MSYS2 Developer - master key) <mingw.android@gmail.com>" not changed
  gpg: Total number processed: 1
  gpg:              unchanged: 1
  gpg: error retrieving 'alexpux@gmail.com' via WKD: No data
  gpg: error reading key: No data
  gpg: refreshing 1 key from hkps://keyserver.ubuntu.com
  gpg: key 5F92EFC1A47D45A1: "Alexey Pavlov (Alexpux) <alexpux@gmail.com>" not changed
  gpg: Total number processed: 1
  gpg:              unchanged: 1
  gpg: error retrieving 'david.macek.0@gmail.com' via WKD: No data
  gpg: error reading key: No data
  gpg: refreshing 1 key from hkps://keyserver.ubuntu.com
  gpg: key 974C8BE49078F532: "David Macek <david.macek.0@gmail.com>" not changed
  gpg: Total number processed: 1
  gpg:              unchanged: 1
  gpg: error retrieving 'reiter.christoph@gmail.com' via WKD: No data
  gpg: error reading key: No data
  gpg: refreshing 1 key from hkps://keyserver.ubuntu.com
  gpg: key FA11531AA0AA7F57: "Christoph Reiter (MSYS2 development key) <reiter.christoph@gmail.com>" not changed
  gpg: Total number processed: 1
  gpg:              unchanged: 1
  gpg: error retrieving 'me@martellmalone.com' via WKD: General error
  gpg: error reading key: General error
  gpg: refreshing 1 key from hkps://keyserver.ubuntu.com
  gpg: key 794DCF97F93FC717: "Martell Malone (martell) <me@martellmalone.com>" not changed
  gpg: Total number processed: 1
  gpg:              unchanged: 1
  gpg: error retrieving 'martellmalone@gmail.com' via WKD: No data
  gpg: error reading key: No data
  gpg: refreshing 1 key from hkps://keyserver.ubuntu.com
  gpg: key D595C9AB2C51581E: "Martell Malone (MSYS2 Developer) <martellmalone@gmail.com>" not changed
  gpg: Total number processed: 1
  gpg:              unchanged: 1
  gpg: error retrieving 'mingw.android@gmail.com' via WKD: No data
  gpg: error reading key: No data
  gpg: refreshing 1 key from hkps://keyserver.ubuntu.com
  gpg: key 4DF3B7664CA56930: "Ray Donnelly (MSYS2 Developer) <mingw.android@gmail.com>" not changed
  gpg: Total number processed: 1
  gpg:              unchanged: 1
  Initial setup complete. MSYS2 is now ready to use.
#### update gems - fail
gem up
  Updating installed gems
  Updating psych
  Temporarily enhancing PATH for MSYS/MINGW...
  Installing required msys2 packages: mingw-w64-ucrt-x86_64-libyaml
  ERROR:  While executing gem ... (Gem::FilePermissionError)
    You don't have write permissions for the C:/Ruby34-x64/lib/ruby/gems/3.4.0/gems/psych-5.2.3/CONTRIBUTING.md directory.
        C:/Ruby34-x64/lib/ruby/3.4.0/rubygems/installer.rb:340:in 'Gem::Installer#install'
        C:/Ruby34-x64/lib/ruby/3.4.0/rubygems/resolver/specification.rb:105:in 'Gem::Resolver::Specification#install'
        C:/Ruby34-x64/lib/ruby/3.4.0/rubygems/request_set.rb:195:in 'block in Gem::RequestSet#install'
        C:/Ruby34-x64/lib/ruby/3.4.0/rubygems/request_set.rb:183:in 'Array#each'
        C:/Ruby34-x64/lib/ruby/3.4.0/rubygems/request_set.rb:183:in 'Gem::RequestSet#install'
        C:/Ruby34-x64/lib/ruby/3.4.0/rubygems/dependency_installer.rb:250:in 'Gem::DependencyInstaller#install'
        C:/Ruby34-x64/lib/ruby/3.4.0/rubygems/commands/update_command.rb:248:in 'Gem::Commands::UpdateCommand#update_gem'
        C:/Ruby34-x64/lib/ruby/3.4.0/rubygems/commands/update_command.rb:260:in 'block in Gem::Commands::UpdateCommand#update_gems'
        C:/Ruby34-x64/lib/ruby/3.4.0/rubygems/commands/update_command.rb:259:in 'Array#each'
        C:/Ruby34-x64/lib/ruby/3.4.0/rubygems/commands/update_command.rb:259:in 'Gem::Commands::UpdateCommand#update_gems'
        C:/Ruby34-x64/lib/ruby/3.4.0/rubygems/commands/update_command.rb:120:in 'Gem::Commands::UpdateCommand#execute'
        C:/Ruby34-x64/lib/ruby/3.4.0/rubygems/command.rb:326:in 'Gem::Command#invoke_with_build_args'
        C:/Ruby34-x64/lib/ruby/3.4.0/rubygems/command_manager.rb:253:in 'Gem::CommandManager#invoke_command'
        C:/Ruby34-x64/lib/ruby/3.4.0/rubygems/command_manager.rb:194:in 'Gem::CommandManager#process_args'
        C:/Ruby34-x64/lib/ruby/3.4.0/rubygems/command_manager.rb:152:in 'Gem::CommandManager#run'
        C:/Ruby34-x64/lib/ruby/3.4.0/rubygems/gem_runner.rb:57:in 'Gem::GemRunner#run'
        C:/Ruby34-x64/bin/gem.cmd:20:in '<main>'
#### update gems
PSA> gem up
  Updating installed gems
  Updating psych
  Temporarily enhancing PATH for MSYS/MINGW...
  Using msys2 packages: mingw-w64-ucrt-x86_64-libyaml
  Building native extensions. This could take a while...
  Successfully installed psych-5.2.3
  Parsing documentation for psych-5.2.3
  Installing ri documentation for psych-5.2.3
  Done installing documentation for psych after 3 seconds
  Parsing documentation for psych-5.2.3
  Done installing documentation for psych after 0 seconds
  Gems updated: psych
## sd
winget add chmln.sd
## Scoop
irm get.scoop.sh | iex
## rga
scoop install rga
  brought in 7zip ffmpeg pandoc poppler rga ripgrep, all shim'd
  splitting WT crashed the process, recovered on next try
## Notepad++ plugin
CSVLint
## zoxide
winget add zoxide
pulled over the data and removed ZLocation module directories
## GitHub CLI
winget add GitHub.cli
## Corepack & markdown-preview.nvim
APS> corepack enable
but  markdown-preview.nvim  not getting loaded, so  APS> corepack disable
  didn't seem to remove anything, but made the non-functional  yarn  command totally unavailable
APS> corepack enable  still not getting  markdown-preview.nvim  loaded
yarn exec env
  ...
  yarn exec v1.22.22
  error Couldn't find the binary env
so I Deleted  $lazy/markdown-preview.nvim
## Dropbox 217.4.4417.0
needed to Sign in again, though it remembered my preferences
  There's already a folder or file named Dropbox
so had to quit  AutoHotkey  script to be able to rename  D:\Dropbox  to  D:\Dropbo
  so's I could get going again with  D:\Dropbox
  which I immediately quit to copy over all of  D:\Dropbo  except  .dropbox  $  .dropbox.cache
  then relaunched  Dropbox, thus starting a full re-indexation
Dropbox  not in  Start Menu, so  winget add Dropbox.Dropbox
full re-indexation
## Thunderbird v128.11.1
complaint about the profile as it's been upgraded for v139.0.2-1
### Winget
g C:\Users\jharr\AppData\Local\Temp\WinGet\cache\V2_PVD\Microsoft.Winget.Source_8wekyb3d8bbwe\packages  shows there to be
  Mozilla.Thunderbird
  Mozilla.Thunderbird.ESR.fr
  Mozilla.Thunderbird.fr
  all containing empty xxxxxxxx subdirectories
## Thunderbird v139.0.2
Applications et fonctionnalités > Mozilla Thunderbird (x64 fr) > Désinstaller >
  C:\Program Files\Mozilla Thunderbird
precautionary reboot
winget add mozilla.thunderbird
thunderbird
## Thunderbird in French
Settings > General > Language > was English (US) with US style dates, so
  Search > Français > Add > Appliquer et redémarrer
## LibreOffice light
alt+f12 > Apparence > Apparence > Claire
## Thunderbird v141.0
## Perl - utf8::all - ppm fail
ppm install utf8::all
  Error installing package 'utf8-all': Could not locate a PPD file for package utf8-all
## Perl - utf8::all - cpanm fail
cpanm utf8::all
  ...
  Successfully installed Import-Into-1.002005
  ...
  Successfully installed utf8-all-0.024
$HOME\.cpanm\latest-build\utf8-all-0.024\README
perl -e 'use utf8::all;'  got me  Can't locate utf8/all.pm in @INC (you may need to install the utf8::all module) (@INC entries checked: C:/Strawberry/perl/site/lib C:/Strawberry/perl/vendor/lib C:/Strawberry/perl/lib)
## Perl - utf8::all - cpan
cpan utf8::all
  ...
  Writing Makefile for utf8::all
  ...
  Writing Makefile for Import::Into
## Perl - cpan
cpan > o conf init pushy_https  got me  commit wrote C:/Strawberry/perl/lib/CPAN/Config.pm
## Perl - Log::Log4perl
(for  cpan) cpanm -i Log::Log4perl
## ConEmu
winget add ConEmu
ran it for  (settings > $Env:AppData\ConEmu.xml), startup task > {Shells::PowerShell Core},
  interface > fr, Single instance mode
## Everything v1.4.1.1024
Everything-1.4.1.1028.x64-Setup.exe > clicked through > UAC
## Alacritty
winget add Alacritty
## ~ damaged
due to accidentally running  $onGH/FM-underscores/underscores.pl  therein...
### repairs to  dot folders
that'd been renamed  underscore...
### repairs to  Microsoft Edge
edge://extensions/  all reporting  Cette extension a peut-être été endommagée.
### repairs to  PowerShell
winget add zoxide  failed, so  winget rm zoxide; winget add zoxide
winget add gokcehan.lf  failed, so  winget rm gokcehan.lf; winget add gokcehan.lf
uninstall-module burnttoast; isres BurntToast
cmu  gets me  InvalidOperation: Unable to find type [Windows.UI.Notifications.ToastNotificationManager,Windows.UI.Notifications, ContentType=WindowsRuntime]. InvalidOperation: Unable to find type [Windows.Data.Xml.Dom.XmlDocument,Windows.Data.Xml.Dom.XmlDocument, ContentType=WindowsRuntime]. InvalidOperation: Unable to find type [Windows.Data.Xml.Dom.XmlDocument].
rmo ps.checkModuleUpdates, isres ps.checkModuleUpdates  having no effect, so
  winget ls Microsoft.PowerShell; winget rm Microsoft.PowerShell; winget add Microsoft.PowerShell
winget ls fzf; winget rm fzf; winget add fzf
winget ls sharkdp.bat; winget rm sharkdp.bat; winget add sharkdp.bat
winget rm sharkdp.fd; winget add sharkdp.fd
winget rm lsd; winget add lsd
### repairs to  $HADL
underscores back to dots
### repairs to  Vim
$mason  deleted, but still  :MasonInstall ...  doesn`t close off at end...
## WSL Ubuntu 24.04.1 LTS Ruby
sudo apt install gnuplot  installed a load of packages
## MiniTool Partition Wizard Free v13.0
allowed, refusing  MiniTool ShadowMaker Free
ran it for "Ne pas afficher ce message à nouveau."
## Thunderbird v143.0.1
## ESU
Windows Update > La prise en charge de Windows 10 se termine en octobre 2025 >
  S'inscrire maintenant > Suivant >
  Mise à jour de sécurité étendues ... jusqu'au 13 octobre 2026 > Inscrivez-vous > Terminé
## 0patch
0PatchInstaller_22.11.11.10550.msi (${env:programfiles(x86)}\0patch) signed in
## pdfimages
where.exe pdfimages
  C:\Users\jharr\scoop\shims\pdfimages.exe
  C:\Users\jharr\AppData\Local\Programs\MiKTeX\miktex\bin\x64\pdfimages.exe
## XpdfReader remove
Paramètres > Applications et fonctionnalités > XpdfReader (Win64) -b Glyph & Cog > Désintaller
## ExifTool v13.39 disaster
accidentally overwrote  $HADL\Microsoft\WindowsApps
MiniTool Partition Wizard Free v13.0 > Récupération de données > C:  didn't find it...
### restore  $HADL\Microsoft\WindowsApp  from  HPEB840G38
robocopy /mir $coreIT\MSWin\ml-HPEB840G38\WindowsApps $HADL\Microsoft\WindowsApps
### remove broken Sykpe
Paramètres > Applications et fonctionnalités > Skype > Désintaller
### replace broken Ubuntu
Should've maybe backed up first...
wsl --unregister Ubuntu
wsl --unregister Ubuntu-24.04
wsl --install -d Ubuntu-24.04 > UNIX username > jo > pw
### WT profiles
ctrl+, (= Paramètres)
  Ubuntu > Le profil n'est plus détecté > Supprimer
  Ubuntu 22.04.4 LTS > Le profil n'est plus détecté > Supprimer
relaunched WT > ctrl+,
  Ubuntu 22.04.4 LTS > Le profil n'est plus détecté > Supprimer
  but it reappears on new instance, so  Deleted  C:\Users\jharr\AppData\Local\Microsoft\WindowsApps\CanonicalGroupLimited.Ubuntu24.04LTS_79rhkp1fndgsc
still getting "[erreur 2147942593 (0x800700c1) lors du lancement de `ubuntu2404.exe']"
wsl --unregister Ubuntu-24.04  then  wsl -l  shows nothing installed
  Ubuntu 22.04.1 LTS > Supprimer
wsl --install -d Ubuntu-24.04 > UNIX username > jo > pw
AIdc> sfc /scannow  seemed to find some errors so  rebooted  AIdc> sfc /scannow
  La Protection des ressources Windows a détecté des fichiers corrompus et les a réparés.
  Pour les réparations en ligne, les détails sont inclus dans le fichier journal de CBS situé à l'emplacement suivant : windir\Logs\CBS\CBS.log. Exemple : C:\Windows\Logs\CBS\CBS.log. Pour les réparations hors connexion, les détails sont inclus dans le fichier journal fourni par l'indicateur /OFFLOGFILE.
reboot
WT still reporting "[erreur 2147942593 (0x800700c1) lors du lancement de `ubuntu2404.exe']"
reboot
### remove broken  WindowsApps
C:\Users\jharr\AppData\Local\Microsoft\WindowsApps\, all of these:
  Microsoft.DesktopAppInstaller_8wekyb3d8bbwe\python.exe
  Microsoft.DesktopAppInstaller_8wekyb3d8bbwe\python3.exe
  Microsoft.DesktopAppInstaller_8wekyb3d8bbw\WindowsPackageManagerServer.exe
  Microsoft.DesktopAppInstaller_8wekyb3d8bbwe\winget.exe
  Microsoft.GetHelp_8wekyb3d8bbwe\GetHelp.exe
  Microsoft.OutlookForWindows_8wekyb3d8bbwe\olk.exe
  Microsoft.OutlookForWindows_8wekyb3d8bbwe\olkMcpServer.exe
  Microsoft.WindowsTerminal_8wekyb3d8bbwe\wt.exe
  Microsoft.XboxGamingOverlay_8wekyb3d8bbwe\GameBarElevatedFT_Alias.exe
  Microsoft.ZuneMusic_8wekyb3d8bbwe\MediaPlayer.exe
  GameBarElevatedFT_Alias.exe
  GetHelp.exe
  MediaPlayer.exe
  olk.exe
  olkMcpServer.exe
  python.exe
  python3.exe
  ubuntu2404.exe
  WindowsPackageManagerServer.exe
  winget.exe
  wt.exe
  get a blue pop-up "Cette application ne peut pas s'exécuter sur votre PC" so  Deleted
### WT profiles fail
attempting to launch  Ubuntu 22.04.1 LTS  now gets me
  [erreur 2147942402 (0x80070002) lors du lancement de `ubuntu2404.exe']
  Le fichier spécifié est introuvable.
wsl --unregister Ubuntu-24.04  then  wsl -l  shows nothing installed
  Ubuntu 22 > Supprimer, Ubuntu 22.04.1 LTS > Supprimer, Enregistrer
wsl --install -d Ubuntu-24.04 > UNIX username > jo > pw
Even after a reboot, didn't appear as a profile...
### repair WinGet fail
winget  not recognised
https://apps.microsoft.com/detail/9nblggh4nns1 > Installer  button becomes  Installé  greyed-out
APS> get-appxpackage -allusers *DesktopAppInstaller* |  Foreach {Add-AppxPackage -DisableDevelopmentMode -Register "$($_.InstallLocation)\AppXManifest.xml"}
  get-appxpackage: The 'get-appxpackage' command was found in the module 'Appx', but the module could not be loaded due to the following error: [Operation is not supported on this platform. (0x80131539)] For more information, run 'Import-Module Appx'.
PS> Add-AppxPackage -RegisterByFamilyName -MainPackage Microsoft.DesktopAppInstaller_8wekyb3d8bbwe
  Add-AppxPackage: The 'Add-AppxPackage' command was found in the module 'Appx', but the module could not be loaded due to the following error: [Operation is not supported on this platform. (0x80131539)] For more information, run 'Import-Module Appx'.
AIdc> sfc /scannow  seemed to find some errors so  rebooted  AIdc> sfc /scannow
  Le programme de protection des ressources Windows n’a trouvé aucune violation d’intégrité.
AIdc> DISM /Online /Cleanup-Image /CheckHealth
  Aucun endommagement du magasin de composants n’a été détecté.
### repair my Win10 user profile
(following windowsreport) Win+r > regedit > Computer\HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList\S-1-5-21-3441228617-810572567-2332938472-1002 > right-clicked in there > Nouveau > Valeur DWORD 32bits > reboot
https://apps.microsoft.com/detail/9nblggh4nns1 > Installer  button becomes  Installé  greyed-out
winget  still not known...
Comptes > Famille et autres utilisateurs > jnbh@live.co.uk > Administrateur/adulte
logged in  jnbh Jo, approved in Microsoft Authenticator app on  Sony Xperia 10 II > PIN > jjjj
logged in  jharrio Jo
APS> robocopy /E C:\Users\jnbh\AppData\Local\Microsoft\WindowsApps $HADL\Microsoft\WindowsApps
winget
  ResourceUnavailable: Program 'winget.exe' failed to run: An error occurred trying to start process 'C:\Users\jharr\AppData\Local\Microsoft\WindowsApps\winget.exe' with working directory 'C:\Windows\System32'. The specified executable is not a valid application for this OS platform.At line:1 char:1
### re-install jharrio Jo
logged out of  jharrio Jo  and into  jnbh Jo
  Comptes > Famille et autres utilisateurs > jharrio Jo > Supprimer
  precautionary reboot
logged into  jnbh Jo
  Signed into Edge jnbh  which allowed  Comptes > Famille et autres utilisateurs > Votre famille
    to find  jharrio@outlook.com  Autoriser
logged into  jharrio Jo, approved in Microsoft Authenticator app on  Sony Xperia 10 II > PIN
### rebuild  jharrio Jo
#### Hamachi
after a reboot, Système > Préférences > Paramètres > bienvenue décoché
#### Ditto Clipboard
Microsoft Store > Ditto Clipboard > Install > Pin to Start
Ran it for  Options > General > [ Maximum Number of Saved Copies > 5000
  Advanced > Show leading whitespace ] ( C:\Users\jharr\AppData\Local\Ditto_WindowsApp\Ditto.db )
  Keyboard Shortcuts > Activate Ditto > ctrl+*
#### Edge
see  $ITsCP/WAN/browsers/browsers.txt
#### Paramètres
Options d'ergonomie > Clavier > all off
Périphériques > Saisie > Orthographie >
  Corriger automatiquement les fautes d'orthograpie > Désactvé
##### Personnalisation
Arrière-plan > Couleur unie
Couleurs > Choisir votre mode d'application par défaut > Sombre
##### Système
Alimentation et mise en veille > Jamais, Jamais, 10 minutes, Jamais
  Paramètres d'alimentation supplémentaire >
    Choisir l'action des boutons d'alimentation >
    [ Modifier des paramètres actuellement non disponibles >
    Activer le démarrage rapide (needed PIN jjjj  off-ticked)
    Lorsque je referme le capot > Sur secteur > Ne rien faire ]
Comptes > Options de connexion > Code PIN de Windows Hello > Modifier
Écran >
  Luminosité et couleur > Éclairage nocturne > Activé
  Mise à l'échelle et disposition > Modifier la taille du texte des applications et d'autres éléments > 100%
  Résolution de l'écran > 1366 x 768 (recommandé)
Multitâche > Alt + Tab > Uniquement les fenêtres ouvertes
Stockage (L'Assistant de stockage) > Activé
#### File Explorer
Affichage > Options > Affichage >
  [ Afficher l'icône des fichiers sur les miniatures  Afficher la barre d'état ] off-ticked
  Afficher le chemin d'accès complet dans la barre de titre  on-ticked
  Afficher les fichiers, dossier et lecteurs cachés
  [ Masquer les extensions des fichiers dont le type est connu
    Masquer les fichier protégés du système d'exploitation ] off-ticked
#### KeePassXC
ran it for  Oui > Ouvrir une base de données > D:\Dropbox\JH\core\encrypted\JH.kdbx > pw
ctrl+, (= Outils > Paramètres) > [
  (Général > Démarrage > Lancer automatiquement KeePassXC au démarrage du système  off)
  Intégration aux navigateurs > Activer > [ Chrome, Vivaldi, and Brave  Firefow and Tor Browser  Edge ]
restarted Edge > HPEB840G38-Edge
#### Dropbox fails
Signed in, renamed  D:\Dropbox  to  D:\Dropbo  so's I could get going again with  D:\Dropbox
  which I immediately quit to copy over all of  D:\Dropbo
  then relaunched  Dropbox, thus starting a full re-indexation
full re-indexation, 119 seemingly random files in  D:\Dropbox\Cop\OutThere
  "Pour synchroniser ce fichier, autorisez Dropbox à y accéder."
so in  D:\Dropbox\Cop, APS> takeown /f . /r /d o  didn't help
  so removed that directory from selective sync
Deleted  D:\Dropbox\.dropbox.cache D:\Dropbox\.dropbox
still getting unsynchable files, so  Uninstalled  Dropbox
#### Dropbox again
Edge > dropbox.com > DropboxInstaller.exe > English & Selective sync
  this time just copied the new  D:\Dropbox\.dropbox.cache  &  D:\Dropbox\.dropbox  into  D:\Dropbo
    Deleted  D:\Dropbox  then renamed  D:\Dropbo  to  D:\Dropbox
  still getting unsynchable files, so  AIdc> sfc /scannow  found no faults, so
    APS> chkdsk d: /f  was quick and found no problems
removed  $DrCop  &  $Thb  from  Selective Sync, then Deleted both from  D:\
  - both requiring Administrator Permission...
  after  reboot  Dropbox completely stuck on 86k files so  Quit  for
    Deleted  D:\Dropbox\.dropbox.cache D:\Dropbox\.dropbox
    still stuck so renamed to  D:\Dropbo, zero files downloaded after 6h, so
      MiniTool Partition Wizard Free v13 > D: > Supprimer > Créer > HX256GSSDSATA3
      then made  D:\Dropbox, and launched it, getting no donwloads arriving, so
      Uninstalled, rebooted, reinstalled, Selective Sync, D:\Dropbox  and the files arrived
#### AutoHotkey
Shortcut to  $MSn\AutoHotkey\HPEB840G37.ahk  placed in
  "$Env:AppData\Microsoft\Windows\Start Menu\Programs\Startup"
#### WPS
clic droit sur toolbar pour  Propriétés > Couleurs > Opacité > 86%
##### execution policy
Get-ExecutionPolicy   reported  "Restricted"
Get-ExecutionPolicy -list  reported all as  "Undefined"
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser -Confirm > o > o
##### modules
iterations of  $MSWin10\build\PSmodules.ps1
#### Gestionnaire de tâches
Options > Masquer l'icône réduite
hidden icon dragged to taskbar
#### WT configure
ctrl+, (= Paramètres)
  Azure Cloud Shell > Masquez le profil de la liste déroulante > Activé  and those for VS
  Interaction > M'avertir lorsque je ferme plusieurs onglets  off-slid
  PowerShell > Répertoire de démarrage > . > Apparence >
    [ Text > Taille de police > 9  Transparence > Opacité de l'arrière plan > 80% ] > Enregistrer
  Windows PowerShell > Répertoire de démarrage > . > Apparence >
    [ Text > Taille de police > 9  Transparence > Opacité de l'arrière plan > 82% ] > Enregistrer
## Microsoft Teams
Skype  got it downloaded in
## continue rebuilding  jharrio Jo
#### WPS modules
more iterations of  $MSWin10\build\PSmodules.ps1
### fzf.exe (for PSFzf)
$MSWin10\build\fzf.ps1
### symlinks - for PS/WPS
got into  $MSn\set  for APS> . 0-_MSn.ps1  . 1-PSProfileStub.ps1  . 2-PSProfile.ps1
winget add zoxide  for  APS> . 3.ps1
### AltSnap
winget add altsnap
APS> schtasks /create /f /tn "AltSnap onlogon" /tr "$Env:AppData\AltSnap\AltSnap.exe" /sc onlogon /rl highest
rebooted to get it working
PS> $ASi="$HADR\AltSnap\AltSnap.ini"; (gc $ASi).replace('AutoSnap=2','AutoSnap=0') | seco -encoding utf8 $ASi
### PS modules
$MSWin10\build\PSmodules.ps1
### symlinks
$MSn/set/3.ps1
### LSD
winget add lsd
### sharkdp/bat
winget add sharkdp.bat
### gokcehan's lf
winget add gokcehan.lf
### BgInfo
winget add BgInfo
& $HADLM\WinGet\Packages\Microsoft.Sysinternals.BGInfo_Microsoft.Winget.Source_8wekyb3d8bbwe\bginfo.exe > OK > font down to 8 and Grey 50%, positioned top right
## waiting
Ghostscript v10.06
Mise à jour facultatives
WSL
# physical configuration
1920x1080 screen
Intel Core i5-6300U
## storage
(essential) M.2 SSD: 119Go
(optional) 2.5" SSD: 238Go HX256GSSDSATA3, shimmed
## Startup Menu
hold  esc  at start to get into  Startup Menu
hold  f9  at start to get into  Boot Menu
hold  f10  at start to get into  BIOS Setup
### BIOS Setup
Main > System Information > System BIOS : N75 Ver. 01.53 11/19/2021
#### Advanced
Built-in Device Options > Backlit keyboard timeout > 30 secs.
Secure Boot Configuration > Legacy Support Enable and Secure Boot Disable
